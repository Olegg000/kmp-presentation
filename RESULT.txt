
# ==============================================================================
# Файл: build.gradle.kts
# Полный путь (относительно корня сканирования): build.gradle.kts
# ==============================================================================

plugins {
    // Здесь мы объявляем плагины, но не применяем их (apply false)
    // Это нужно, чтобы модули "видели" эти плагины.
    alias(libs.plugins.androidApplication) apply false
    alias(libs.plugins.androidLibrary) apply false
    alias(libs.plugins.kotlinMultiplatform) apply false
    alias(libs.plugins.composeMultiplatform) apply false
    alias(libs.plugins.composeCompiler) apply false

    // Вот твои проблемные плагины - объявляем их тут!
    alias(libs.plugins.kotlinSerialization) apply false
    alias(libs.plugins.ksp) apply false
    alias(libs.plugins.room) apply false
}

# --- КОНЕЦ ФАЙЛА: build.gradle.kts --- 


# ==============================================================================
# Файл: gradle.properties
# Полный путь (относительно корня сканирования): gradle.properties
# ==============================================================================

#Kotlin
kotlin.code.style=official
kotlin.daemon.jvmargs=-Xmx3072M

#Gradle
org.gradle.jvmargs=-Xmx4096M -Dfile.encoding=UTF-8
org.gradle.configuration-cache=true
org.gradle.caching=true

#Android
android.nonTransitiveRClass=true
android.useAndroidX=true

# --- КОНЕЦ ФАЙЛА: gradle.properties --- 

# ==============================================================================
# Файл: settings.gradle.kts
# Полный путь (относительно корня сканирования): settings.gradle.kts
# ==============================================================================

rootProject.name = "PgkFood"
enableFeaturePreview("TYPESAFE_PROJECT_ACCESSORS")

pluginManagement {
    repositories {
        google {
            mavenContent {
                includeGroupAndSubgroups("androidx")
                includeGroupAndSubgroups("com.android")
                includeGroupAndSubgroups("com.google")
            }
        }
        mavenCentral()
        gradlePluginPortal()
    }
}

dependencyResolutionManagement {
    repositories {
        google {
            mavenContent {
                includeGroupAndSubgroups("androidx")
                includeGroupAndSubgroups("com.android")
                includeGroupAndSubgroups("com.google")
            }
        }
        mavenCentral()
    }
}

include(":composeApp")

# --- КОНЕЦ ФАЙЛА: settings.gradle.kts --- 


# ==============================================================================
# Файл: iosApp/Configuration/Config.xcconfig
# Полный путь (относительно корня сканирования): iosApp/Configuration/Config.xcconfig
# ==============================================================================

TEAM_ID=

PRODUCT_NAME=PgkFood
PRODUCT_BUNDLE_IDENTIFIER=org.pgk.food.PgkFood$(TEAM_ID)

CURRENT_PROJECT_VERSION=1
MARKETING_VERSION=1.0

# --- КОНЕЦ ФАЙЛА: iosApp/Configuration/Config.xcconfig --- 


# ==============================================================================
# Файл: iosApp/iosApp.xcodeproj/project.pbxproj
# Полный путь (относительно корня сканирования): iosApp/iosApp.xcodeproj/project.pbxproj
# ==============================================================================

// !$*UTF8*$!
{
	archiveVersion = 1;
	classes = {
	};
	objectVersion = 77;
	objects = {

/* Begin PBXFileReference section */
		A62931987B138CD1FF1EF870 /* PgkFood.app */ = {isa = PBXFileReference; explicitFileType = wrapper.application; includeInIndex = 0; path = PgkFood.app; sourceTree = BUILT_PRODUCTS_DIR; };
/* End PBXFileReference section */

/* Begin PBXFileSystemSynchronizedBuildFileExceptionSet section */
		95025B18344F0E5FDE6CB6EE /* Exceptions for "iosApp" folder in "iosApp" target */ = {
			isa = PBXFileSystemSynchronizedBuildFileExceptionSet;
			membershipExceptions = (
				Info.plist,
			);
			target = A2F749302AD4FC3C1EA0EEA0 /* iosApp */;
		};
/* End PBXFileSystemSynchronizedBuildFileExceptionSet section */

/* Begin PBXFileSystemSynchronizedRootGroup section */
		512B453B94148F6F511FF550 /* iosApp */ = {
			isa = PBXFileSystemSynchronizedRootGroup;
			exceptions = (
				95025B18344F0E5FDE6CB6EE /* Exceptions for "iosApp" folder in "iosApp" target */,
			);
			path = iosApp;
			sourceTree = "<group>";
		};
		218FE37AF1F4F1F31395E357 /* Configuration */ = {
			isa = PBXFileSystemSynchronizedRootGroup;
			path = Configuration;
			sourceTree = "<group>";
		};
/* End PBXFileSystemSynchronizedRootGroup section */

/* Begin PBXFrameworksBuildPhase section */
		1C315014A91CDE4F42404F0D /* Frameworks */ = {
			isa = PBXFrameworksBuildPhase;
			buildActionMask = 2147483647;
			files = (
			);
			runOnlyForDeploymentPostprocessing = 0;
		};
/* End PBXFrameworksBuildPhase section */

/* Begin PBXGroup section */
		243A2CC977E96446DAE654A9 = {
			isa = PBXGroup;
			children = (
				218FE37AF1F4F1F31395E357 /* Configuration */,
				512B453B94148F6F511FF550 /* iosApp */,
				73AA048CD796FB869C7862D4 /* Products */,
			);
			sourceTree = "<group>";
		};
		73AA048CD796FB869C7862D4 /* Products */ = {
			isa = PBXGroup;
			children = (
				A62931987B138CD1FF1EF870 /* PgkFood.app */,
			);
			name = Products;
			sourceTree = "<group>";
		};
/* End PBXGroup section */

/* Begin PBXNativeTarget section */
		A2F749302AD4FC3C1EA0EEA0 /* iosApp */ = {
			isa = PBXNativeTarget;
			buildConfigurationList = 939F0A4D2DE2A1E2FC91BA47 /* Build configuration list for PBXNativeTarget "iosApp" */;
			buildPhases = (
				0CB504AA39756220BDCB1ECD /* Compile Kotlin Framework */,
				065F4153759EF5886E49FAAA /* Sources */,
				1C315014A91CDE4F42404F0D /* Frameworks */,
				24B879526C310E5F10D41C44 /* Resources */,
			);
			buildRules = (
			);
			dependencies = (
			);
			fileSystemSynchronizedGroups = (
				512B453B94148F6F511FF550 /* iosApp */,
			);
			name = iosApp;
			packageProductDependencies = (
			);
			productName = iosApp;
			productReference = A62931987B138CD1FF1EF870 /* PgkFood.app */;
			productType = "com.apple.product-type.application";
		};
/* End PBXNativeTarget section */

/* Begin PBXProject section */
		2E58668704227402EC4A152C /* Project object */ = {
			isa = PBXProject;
			attributes = {
				BuildIndependentTargetsInParallel = 1;
				LastSwiftUpdateCheck = 1620;
				LastUpgradeCheck = 1620;
				TargetAttributes = {
					A2F749302AD4FC3C1EA0EEA0 = {
						CreatedOnToolsVersion = 16.2;
					};
				};
			};
			buildConfigurationList = 67B6E75CAB30534B721B4205 /* Build configuration list for PBXProject "iosApp" */;
			developmentRegion = en;
			hasScannedForEncodings = 0;
			knownRegions = (
				en,
				Base,
			);
			mainGroup = 243A2CC977E96446DAE654A9;
			minimizedProjectReferenceProxies = 1;
			preferredProjectObjectVersion = 77;
			productRefGroup = 73AA048CD796FB869C7862D4 /* Products */;
			projectDirPath = "";
			projectRoot = "";
			targets = (
				A2F749302AD4FC3C1EA0EEA0 /* iosApp */,
			);
		};
/* End PBXProject section */

/* Begin PBXResourcesBuildPhase section */
		24B879526C310E5F10D41C44 /* Resources */ = {
			isa = PBXResourcesBuildPhase;
			buildActionMask = 2147483647;
			files = (
			);
			runOnlyForDeploymentPostprocessing = 0;
		};
/* End PBXResourcesBuildPhase section */

/* Begin PBXShellScriptBuildPhase section */
		0CB504AA39756220BDCB1ECD /* Compile Kotlin Framework */ = {
			isa = PBXShellScriptBuildPhase;
			alwaysOutOfDate = 1;
			buildActionMask = 2147483647;
			files = (
			);
			inputFileListPaths = (
			);
			inputPaths = (
			);
			name = "Compile Kotlin Framework";
			outputFileListPaths = (
			);
			outputPaths = (
			);
			runOnlyForDeploymentPostprocessing = 0;
			shellPath = /bin/sh;
			shellScript = "if [ \"YES\" = \"$OVERRIDE_KOTLIN_BUILD_IDE_SUPPORTED\" ]; then\n  echo \"Skipping Gradle build task invocation due to OVERRIDE_KOTLIN_BUILD_IDE_SUPPORTED environment variable set to \\\"YES\\\"\"\n  exit 0\nfi\ncd \"$SRCROOT/..\"\n./gradlew :composeApp:embedAndSignAppleFrameworkForXcode\n";
		};
/* End PBXShellScriptBuildPhase section */

/* Begin PBXSourcesBuildPhase section */
		065F4153759EF5886E49FAAA /* Sources */ = {
			isa = PBXSourcesBuildPhase;
			buildActionMask = 2147483647;
			files = (
			);
			runOnlyForDeploymentPostprocessing = 0;
		};
/* End PBXSourcesBuildPhase section */

/* Begin XCBuildConfiguration section */
		EEA511C433AB172AFE5E5686 /* Debug */ = {
			isa = XCBuildConfiguration;
			baseConfigurationReferenceAnchor = 218FE37AF1F4F1F31395E357 /* Configuration */;
			baseConfigurationReferenceRelativePath = Config.xcconfig;
			buildSettings = {
				ALWAYS_SEARCH_USER_PATHS = NO;
				ASSETCATALOG_COMPILER_GENERATE_SWIFT_ASSET_SYMBOL_EXTENSIONS = YES;
				CLANG_ANALYZER_NONNULL = YES;
				CLANG_ANALYZER_NUMBER_OBJECT_CONVERSION = YES_AGGRESSIVE;
				CLANG_CXX_LANGUAGE_STANDARD = "gnu++20";
				CLANG_ENABLE_MODULES = YES;
				CLANG_ENABLE_OBJC_ARC = YES;
				CLANG_ENABLE_OBJC_WEAK = YES;
				CLANG_WARN_BLOCK_CAPTURE_AUTORELEASING = YES;
				CLANG_WARN_BOOL_CONVERSION = YES;
				CLANG_WARN_COMMA = YES;
				CLANG_WARN_CONSTANT_CONVERSION = YES;
				CLANG_WARN_DEPRECATED_OBJC_IMPLEMENTATIONS = YES;
				CLANG_WARN_DIRECT_OBJC_ISA_USAGE = YES_ERROR;
				CLANG_WARN_DOCUMENTATION_COMMENTS = YES;
				CLANG_WARN_EMPTY_BODY = YES;
				CLANG_WARN_ENUM_CONVERSION = YES;
				CLANG_WARN_INFINITE_RECURSION = YES;
				CLANG_WARN_INT_CONVERSION = YES;
				CLANG_WARN_NON_LITERAL_NULL_CONVERSION = YES;
				CLANG_WARN_OBJC_IMPLICIT_RETAIN_SELF = YES;
				CLANG_WARN_OBJC_LITERAL_CONVERSION = YES;
				CLANG_WARN_OBJC_ROOT_CLASS = YES_ERROR;
				CLANG_WARN_QUOTED_INCLUDE_IN_FRAMEWORK_HEADER = YES;
				CLANG_WARN_RANGE_LOOP_ANALYSIS = YES;
				CLANG_WARN_STRICT_PROTOTYPES = YES;
				CLANG_WARN_SUSPICIOUS_MOVE = YES;
				CLANG_WARN_UNGUARDED_AVAILABILITY = YES_AGGRESSIVE;
				CLANG_WARN_UNREACHABLE_CODE = YES;
				CLANG_WARN__DUPLICATE_METHOD_MATCH = YES;
				COPY_PHASE_STRIP = NO;
				DEBUG_INFORMATION_FORMAT = dwarf;
				ENABLE_STRICT_OBJC_MSGSEND = YES;
				ENABLE_TESTABILITY = YES;
				ENABLE_USER_SCRIPT_SANDBOXING = NO;
				GCC_C_LANGUAGE_STANDARD = gnu17;
				GCC_DYNAMIC_NO_PIC = NO;
				GCC_NO_COMMON_BLOCKS = YES;
				GCC_OPTIMIZATION_LEVEL = 0;
				GCC_PREPROCESSOR_DEFINITIONS = (
					"DEBUG=1",
					"$(inherited)",
				);
				GCC_WARN_64_TO_32_BIT_CONVERSION = YES;
				GCC_WARN_ABOUT_RETURN_TYPE = YES_ERROR;
				GCC_WARN_UNDECLARED_SELECTOR = YES;
				GCC_WARN_UNINITIALIZED_AUTOS = YES_AGGRESSIVE;
				GCC_WARN_UNUSED_FUNCTION = YES;
				GCC_WARN_UNUSED_VARIABLE = YES;
				IPHONEOS_DEPLOYMENT_TARGET = 18.2;
				LOCALIZATION_PREFERS_STRING_CATALOGS = YES;
				MTL_ENABLE_DEBUG_INFO = INCLUDE_SOURCE;
				MTL_FAST_MATH = YES;
				ONLY_ACTIVE_ARCH = YES;
				SDKROOT = iphoneos;
				SWIFT_ACTIVE_COMPILATION_CONDITIONS = "DEBUG $(inherited)";
				SWIFT_OPTIMIZATION_LEVEL = "-Onone";
			};
			name = Debug;
		};
		F0370D6D97DE16F0D26AA38A /* Release */ = {
			isa = XCBuildConfiguration;
			baseConfigurationReferenceAnchor = 218FE37AF1F4F1F31395E357 /* Configuration */;
			baseConfigurationReferenceRelativePath = Config.xcconfig;
			buildSettings = {
				ALWAYS_SEARCH_USER_PATHS = NO;
				ASSETCATALOG_COMPILER_GENERATE_SWIFT_ASSET_SYMBOL_EXTENSIONS = YES;
				CLANG_ANALYZER_NONNULL = YES;
				CLANG_ANALYZER_NUMBER_OBJECT_CONVERSION = YES_AGGRESSIVE;
				CLANG_CXX_LANGUAGE_STANDARD = "gnu++20";
				CLANG_ENABLE_MODULES = YES;
				CLANG_ENABLE_OBJC_ARC = YES;
				CLANG_ENABLE_OBJC_WEAK = YES;
				CLANG_WARN_BLOCK_CAPTURE_AUTORELEASING = YES;
				CLANG_WARN_BOOL_CONVERSION = YES;
				CLANG_WARN_COMMA = YES;
				CLANG_WARN_CONSTANT_CONVERSION = YES;
				CLANG_WARN_DEPRECATED_OBJC_IMPLEMENTATIONS = YES;
				CLANG_WARN_DIRECT_OBJC_ISA_USAGE = YES_ERROR;
				CLANG_WARN_DOCUMENTATION_COMMENTS = YES;
				CLANG_WARN_EMPTY_BODY = YES;
				CLANG_WARN_ENUM_CONVERSION = YES;
				CLANG_WARN_INFINITE_RECURSION = YES;
				CLANG_WARN_INT_CONVERSION = YES;
				CLANG_WARN_NON_LITERAL_NULL_CONVERSION = YES;
				CLANG_WARN_OBJC_IMPLICIT_RETAIN_SELF = YES;
				CLANG_WARN_OBJC_LITERAL_CONVERSION = YES;
				CLANG_WARN_OBJC_ROOT_CLASS = YES_ERROR;
				CLANG_WARN_QUOTED_INCLUDE_IN_FRAMEWORK_HEADER = YES;
				CLANG_WARN_RANGE_LOOP_ANALYSIS = YES;
				CLANG_WARN_STRICT_PROTOTYPES = YES;
				CLANG_WARN_SUSPICIOUS_MOVE = YES;
				CLANG_WARN_UNGUARDED_AVAILABILITY = YES_AGGRESSIVE;
				CLANG_WARN_UNREACHABLE_CODE = YES;
				CLANG_WARN__DUPLICATE_METHOD_MATCH = YES;
				COPY_PHASE_STRIP = NO;
				DEBUG_INFORMATION_FORMAT = "dwarf-with-dsym";
				ENABLE_NS_ASSERTIONS = NO;
				ENABLE_STRICT_OBJC_MSGSEND = YES;
				ENABLE_USER_SCRIPT_SANDBOXING = NO;
				GCC_C_LANGUAGE_STANDARD = gnu17;
				GCC_NO_COMMON_BLOCKS = YES;
				GCC_WARN_64_TO_32_BIT_CONVERSION = YES;
				GCC_WARN_ABOUT_RETURN_TYPE = YES_ERROR;
				GCC_WARN_UNDECLARED_SELECTOR = YES;
				GCC_WARN_UNINITIALIZED_AUTOS = YES_AGGRESSIVE;
				GCC_WARN_UNUSED_FUNCTION = YES;
				GCC_WARN_UNUSED_VARIABLE = YES;
				IPHONEOS_DEPLOYMENT_TARGET = 18.2;
				LOCALIZATION_PREFERS_STRING_CATALOGS = YES;
				MTL_ENABLE_DEBUG_INFO = NO;
				MTL_FAST_MATH = YES;
				SDKROOT = iphoneos;
				SWIFT_COMPILATION_MODE = wholemodule;
				VALIDATE_PRODUCT = YES;
			};
			name = Release;
		};
		0FA34838251F245BB9F545F2 /* Debug */ = {
			isa = XCBuildConfiguration;
			buildSettings = {
				ARCHS = arm64;
				ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon;
				ASSETCATALOG_COMPILER_GLOBAL_ACCENT_COLOR_NAME = AccentColor;
				CODE_SIGN_IDENTITY = "Apple Development";
				CODE_SIGN_STYLE = Automatic;
				DEVELOPMENT_ASSET_PATHS = "\"iosApp/Preview Content\"";
				DEVELOPMENT_TEAM = "${TEAM_ID}";
				ENABLE_PREVIEWS = YES;
				GENERATE_INFOPLIST_FILE = YES;
				INFOPLIST_FILE = iosApp/Info.plist;
				INFOPLIST_KEY_UIApplicationSceneManifest_Generation = YES;
				INFOPLIST_KEY_UIApplicationSupportsIndirectInputEvents = YES;
				INFOPLIST_KEY_UILaunchScreen_Generation = YES;
				INFOPLIST_KEY_UISupportedInterfaceOrientations_iPad = "UIInterfaceOrientationPortrait UIInterfaceOrientationPortraitUpsideDown UIInterfaceOrientationLandscapeLeft UIInterfaceOrientationLandscapeRight";
				INFOPLIST_KEY_UISupportedInterfaceOrientations_iPhone = "UIInterfaceOrientationPortrait UIInterfaceOrientationLandscapeLeft UIInterfaceOrientationLandscapeRight";
				LD_RUNPATH_SEARCH_PATHS = (
					"$(inherited)",
					"@executable_path/Frameworks",
				);
				SWIFT_EMIT_LOC_STRINGS = YES;
				SWIFT_VERSION = 5.0;
				TARGETED_DEVICE_FAMILY = "1,2";
			};
			name = Debug;
		};
		31C795C3C57E5460256C6650 /* Release */ = {
			isa = XCBuildConfiguration;
			buildSettings = {
				ARCHS = arm64;
				ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon;
				ASSETCATALOG_COMPILER_GLOBAL_ACCENT_COLOR_NAME = AccentColor;
				CODE_SIGN_IDENTITY = "Apple Development";
				CODE_SIGN_STYLE = Automatic;
				DEVELOPMENT_ASSET_PATHS = "\"iosApp/Preview Content\"";
				DEVELOPMENT_TEAM = "${TEAM_ID}";
				ENABLE_PREVIEWS = YES;
				GENERATE_INFOPLIST_FILE = YES;
				INFOPLIST_FILE = iosApp/Info.plist;
				INFOPLIST_KEY_UIApplicationSceneManifest_Generation = YES;
				INFOPLIST_KEY_UIApplicationSupportsIndirectInputEvents = YES;
				INFOPLIST_KEY_UILaunchScreen_Generation = YES;
				INFOPLIST_KEY_UISupportedInterfaceOrientations_iPad = "UIInterfaceOrientationPortrait UIInterfaceOrientationPortraitUpsideDown UIInterfaceOrientationLandscapeLeft UIInterfaceOrientationLandscapeRight";
				INFOPLIST_KEY_UISupportedInterfaceOrientations_iPhone = "UIInterfaceOrientationPortrait UIInterfaceOrientationLandscapeLeft UIInterfaceOrientationLandscapeRight";
				LD_RUNPATH_SEARCH_PATHS = (
					"$(inherited)",
					"@executable_path/Frameworks",
				);
				SWIFT_EMIT_LOC_STRINGS = YES;
				SWIFT_VERSION = 5.0;
				TARGETED_DEVICE_FAMILY = "1,2";
			};
			name = Release;
		};
/* End XCBuildConfiguration section */

/* Begin XCConfigurationList section */
		67B6E75CAB30534B721B4205 /* Build configuration list for PBXProject "iosApp" */ = {
			isa = XCConfigurationList;
			buildConfigurations = (
				EEA511C433AB172AFE5E5686 /* Debug */,
				F0370D6D97DE16F0D26AA38A /* Release */,
			);
			defaultConfigurationIsVisible = 0;
			defaultConfigurationName = Release;
		};
		939F0A4D2DE2A1E2FC91BA47 /* Build configuration list for PBXNativeTarget "iosApp" */ = {
			isa = XCConfigurationList;
			buildConfigurations = (
				0FA34838251F245BB9F545F2 /* Debug */,
				31C795C3C57E5460256C6650 /* Release */,
			);
			defaultConfigurationIsVisible = 0;
			defaultConfigurationName = Release;
		};
/* End XCConfigurationList section */
	};
	rootObject = 2E58668704227402EC4A152C /* Project object */;
}

# --- КОНЕЦ ФАЙЛА: iosApp/iosApp.xcodeproj/project.pbxproj --- 


# ==============================================================================
# Файл: iosApp/iosApp.xcodeproj/project.xcworkspace/contents.xcworkspacedata
# Полный путь (относительно корня сканирования): iosApp/iosApp.xcodeproj/project.xcworkspace/contents.xcworkspacedata
# ==============================================================================

<?xml version="1.0" encoding="UTF-8"?>
<Workspace
   version = "1.0">
   <FileRef
      location = "self:">
   </FileRef>
</Workspace>


# --- КОНЕЦ ФАЙЛА: iosApp/iosApp.xcodeproj/project.xcworkspace/contents.xcworkspacedata --- 


# ==============================================================================
# Файл: iosApp/iosApp/ContentView.swift
# Полный путь (относительно корня сканирования): iosApp/iosApp/ContentView.swift
# ==============================================================================

import UIKit
import SwiftUI
import ComposeApp

struct ComposeView: UIViewControllerRepresentable {
    func makeUIViewController(context: Context) -> UIViewController {
        MainViewControllerKt.MainViewController()
    }

    func updateUIViewController(_ uiViewController: UIViewController, context: Context) {}
}

struct ContentView: View {
    var body: some View {
        ComposeView()
            .ignoresSafeArea()
    }
}





# --- КОНЕЦ ФАЙЛА: iosApp/iosApp/ContentView.swift --- 


# ==============================================================================
# Файл: iosApp/iosApp/Info.plist
# Полный путь (относительно корня сканирования): iosApp/iosApp/Info.plist
# ==============================================================================

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>CADisableMinimumFrameDurationOnPhone</key>
	<true/>
</dict>
</plist>


# --- КОНЕЦ ФАЙЛА: iosApp/iosApp/Info.plist --- 


# ==============================================================================
# Файл: iosApp/iosApp/iOSApp.swift
# Полный путь (относительно корня сканирования): iosApp/iosApp/iOSApp.swift
# ==============================================================================

import SwiftUI

@main
struct iOSApp: App {
    var body: some Scene {
        WindowGroup {
            ContentView()
        }
    }
}

# --- КОНЕЦ ФАЙЛА: iosApp/iosApp/iOSApp.swift --- 


# ==============================================================================
# Файл: iosApp/iosApp/Assets.xcassets/Contents.json
# Полный путь (относительно корня сканирования): iosApp/iosApp/Assets.xcassets/Contents.json
# ==============================================================================

{
  "info" : {
    "author" : "xcode",
    "version" : 1
  }
}


# --- КОНЕЦ ФАЙЛА: iosApp/iosApp/Assets.xcassets/Contents.json --- 


# ==============================================================================
# Файл: iosApp/iosApp/Assets.xcassets/AccentColor.colorset/Contents.json
# Полный путь (относительно корня сканирования): iosApp/iosApp/Assets.xcassets/AccentColor.colorset/Contents.json
# ==============================================================================

{
  "colors" : [
    {
      "idiom" : "universal"
    }
  ],
  "info" : {
    "author" : "xcode",
    "version" : 1
  }
}


# --- КОНЕЦ ФАЙЛА: iosApp/iosApp/Assets.xcassets/AccentColor.colorset/Contents.json --- 


# ==============================================================================
# Файл: iosApp/iosApp/Assets.xcassets/AppIcon.appiconset/Contents.json
# Полный путь (относительно корня сканирования): iosApp/iosApp/Assets.xcassets/AppIcon.appiconset/Contents.json
# ==============================================================================

{
  "images" : [
    {
      "filename" : "app-icon-1024.png",
      "idiom" : "universal",
      "platform" : "ios",
      "size" : "1024x1024"
    },
    {
      "appearances" : [
        {
          "appearance" : "luminosity",
          "value" : "dark"
        }
      ],
      "idiom" : "universal",
      "platform" : "ios",
      "size" : "1024x1024"
    },
    {
      "appearances" : [
        {
          "appearance" : "luminosity",
          "value" : "tinted"
        }
      ],
      "idiom" : "universal",
      "platform" : "ios",
      "size" : "1024x1024"
    }
  ],
  "info" : {
    "author" : "xcode",
    "version" : 1
  }
}


# --- КОНЕЦ ФАЙЛА: iosApp/iosApp/Assets.xcassets/AppIcon.appiconset/Contents.json --- 


# ==============================================================================
# Файл: iosApp/iosApp/Assets.xcassets/AppIcon.appiconset/app-icon-1024.png
# Полный путь (относительно корня сканирования): iosApp/iosApp/Assets.xcassets/AppIcon.appiconset/app-icon-1024.png
# ==============================================================================

# ОШИБКА: Не удалось прочитать файл 'iosApp/iosApp/Assets.xcassets/AppIcon.appiconset/app-icon-1024.png'. Кодировка: utf-8, Ошибка: 'utf-8' codec can't encode character '\udc89' in position 0: surrogates not allowed


# --- КОНЕЦ ФАЙЛА: iosApp/iosApp/Assets.xcassets/AppIcon.appiconset/app-icon-1024.png --- 


# ==============================================================================
# Файл: iosApp/iosApp/Preview Content/Preview Assets.xcassets/Contents.json
# Полный путь (относительно корня сканирования): iosApp/iosApp/Preview Content/Preview Assets.xcassets/Contents.json
# ==============================================================================

{
  "info" : {
    "author" : "xcode",
    "version" : 1
  }
}


# --- КОНЕЦ ФАЙЛА: iosApp/iosApp/Preview Content/Preview Assets.xcassets/Contents.json --- 


# ==============================================================================
# Файл: gradle/libs.versions.toml
# Полный путь (относительно корня сканирования): gradle/libs.versions.toml
# ==============================================================================

[versions]
agp = "8.7.3"
kotlin = "2.1.0"
composeMultiplatform = "1.7.1"
androidx-activity = "1.9.3"
androidx-appcompat = "1.7.0"
androidx-core = "1.15.0"
androidx-lifecycle = "2.8.4"

# Библиотеки
voyager = "1.1.0-beta03"
ktor = "3.0.1"
koin = "4.0.0"
room = "2.7.0-alpha11"
sqlite = "2.5.0-alpha11"
peekaboo = "0.5.2"
# KSP версия должна строго подходить к Kotlin версии!
ksp = "2.1.0-1.0.29"

[libraries]
# Voyager
voyager-navigator = { module = "cafe.adriel.voyager:voyager-navigator", version.ref = "voyager" }
voyager-screenModel = { module = "cafe.adriel.voyager:voyager-screenmodel", version.ref = "voyager" }
voyager-koin = { module = "cafe.adriel.voyager:voyager-koin", version.ref = "voyager" }
voyager-transitions = { module = "cafe.adriel.voyager:voyager-transitions", version.ref = "voyager" }

# Ktor
ktor-client-core = { module = "io.ktor:ktor-client-core", version.ref = "ktor" }
ktor-client-content-negotiation = { module = "io.ktor:ktor-client-content-negotiation", version.ref = "ktor" }
ktor-serialization-json = { module = "io.ktor:ktor-serialization-kotlinx-json", version.ref = "ktor" }
ktor-client-okhttp = { module = "io.ktor:ktor-client-okhttp", version.ref = "ktor" }
ktor-client-darwin = { module = "io.ktor:ktor-client-darwin", version.ref = "ktor" }

# Koin
koin-core = { module = "io.insert-koin:koin-core", version.ref = "koin" }
koin-compose = { module = "io.insert-koin:koin-compose", version.ref = "koin" }

# Room
androidx-room-runtime = { module = "androidx.room:room-runtime", version.ref = "room" }
androidx-room-compiler = { module = "androidx.room:room-compiler", version.ref = "room" }
androidx-sqlite-bundled = { module = "androidx.sqlite:sqlite-bundled", version.ref = "sqlite" }

# Peekaboo
peekaboo-ui = { module = "io.github.onseok:peekaboo-ui", version.ref = "peekaboo" }
peekaboo-image-picker = { module = "io.github.onseok:peekaboo-image-picker", version.ref = "peekaboo" }

# Android Standart
androidx-core-ktx = { module = "androidx.core:core-ktx", version.ref = "androidx-core" }
androidx-appcompat = { module = "androidx.appcompat:appcompat", version.ref = "androidx-appcompat" }
androidx-activity-compose = { module = "androidx.activity:activity-compose", version.ref = "androidx-activity" }

androidx-lifecycle-viewmodel = { group = "org.jetbrains.androidx.lifecycle", name = "lifecycle-viewmodel", version.ref = "androidx-lifecycle" }
androidx-lifecycle-runtime-compose = { group = "org.jetbrains.androidx.lifecycle", name = "lifecycle-runtime-compose", version.ref = "androidx-lifecycle" }

[bundles]
voyager = ["voyager-navigator", "voyager-screenModel", "voyager-koin", "voyager-transitions"]
ktor = ["ktor-client-core", "ktor-client-content-negotiation", "ktor-serialization-json"]
peekaboo = ["peekaboo-ui", "peekaboo-image-picker"]

[plugins]
# ВАЖНО: Имена плагинов здесь влияют на то, как ты пишешь их в build.gradle (libs.plugins.ИМЯ)
androidApplication = { id = "com.android.application", version.ref = "agp" }
androidLibrary = { id = "com.android.library", version.ref = "agp" }
composeMultiplatform = { id = "org.jetbrains.compose", version.ref = "composeMultiplatform" }
composeCompiler = { id = "org.jetbrains.kotlin.plugin.compose", version.ref = "kotlin" }
kotlinMultiplatform = { id = "org.jetbrains.kotlin.multiplatform", version.ref = "kotlin" }
kotlinSerialization = { id = "org.jetbrains.kotlin.plugin.serialization", version.ref = "kotlin" }
ksp = { id = "com.google.devtools.ksp", version.ref = "ksp" }
room = { id = "androidx.room", version.ref = "room" }


# --- КОНЕЦ ФАЙЛА: gradle/libs.versions.toml --- 


# ==============================================================================
# Файл: gradle/wrapper/gradle-wrapper.jar
# Полный путь (относительно корня сканирования): gradle/wrapper/gradle-wrapper.jar
# ==============================================================================

# ОШИБКА: Не удалось прочитать файл 'gradle/wrapper/gradle-wrapper.jar'. Кодировка: utf-8, Ошибка: 'utf-8' codec can't encode character '\udcdd' in position 55: surrogates not allowed


# --- КОНЕЦ ФАЙЛА: gradle/wrapper/gradle-wrapper.jar --- 


# ==============================================================================
# Файл: gradle/wrapper/gradle-wrapper.properties
# Полный путь (относительно корня сканирования): gradle/wrapper/gradle-wrapper.properties
# ==============================================================================

distributionBase=GRADLE_USER_HOME
distributionPath=wrapper/dists
distributionUrl=https\://services.gradle.org/distributions/gradle-8.14.3-bin.zip
networkTimeout=10000
validateDistributionUrl=true
zipStoreBase=GRADLE_USER_HOME
zipStorePath=wrapper/dists


# --- КОНЕЦ ФАЙЛА: gradle/wrapper/gradle-wrapper.properties --- 


# ==============================================================================
# Файл: composeApp/build.gradle.kts
# Полный путь (относительно корня сканирования): composeApp/build.gradle.kts
# ==============================================================================

import org.jetbrains.kotlin.gradle.ExperimentalKotlinGradlePluginApi
import org.jetbrains.kotlin.gradle.dsl.JvmTarget

plugins {
    alias(libs.plugins.kotlinMultiplatform)
    alias(libs.plugins.androidApplication)
    alias(libs.plugins.composeMultiplatform)
    alias(libs.plugins.composeCompiler)
    alias(libs.plugins.kotlinSerialization)
    alias(libs.plugins.ksp)
    alias(libs.plugins.room)
}

kotlin {
    androidTarget {
        @OptIn(ExperimentalKotlinGradlePluginApi::class)
        compilerOptions {
            jvmTarget.set(JvmTarget.JVM_11)
        }
    }

    listOf(
        iosX64(),
        iosArm64(),
        iosSimulatorArm64()
    ).forEach { iosTarget ->
        iosTarget.binaries.framework {
            baseName = "ComposeApp"
            isStatic = true
        }
    }

    sourceSets {
        androidMain.dependencies {
            implementation(compose.preview)
            implementation(libs.androidx.activity.compose)
            implementation(libs.androidx.appcompat)
            implementation(libs.androidx.core.ktx)

            // Ktor Android
            implementation(libs.ktor.client.okhttp)

            // CameraX для QR сканирования
            implementation("androidx.camera:camera-camera2:1.3.1")
            implementation("androidx.camera:camera-lifecycle:1.3.1")
            implementation("androidx.camera:camera-view:1.3.1")

            // ML Kit для распознавания QR
            implementation("com.google.mlkit:barcode-scanning:17.2.0")

            // Room Android
            implementation(libs.androidx.room.runtime)
            implementation(libs.androidx.sqlite.bundled)
        }

        iosMain.dependencies {
            // Ktor iOS
            implementation(libs.ktor.client.darwin)
        }

        commonMain.dependencies {
            implementation(compose.runtime)
            implementation(compose.foundation)
            implementation(compose.material3)
            implementation(compose.ui)
            implementation(compose.components.resources)
            implementation(compose.components.uiToolingPreview)
            implementation(libs.androidx.lifecycle.viewmodel)
            implementation(libs.androidx.lifecycle.runtime.compose)

            // Voyager Navigation
            implementation(libs.bundles.voyager)

            // Ktor Client
            implementation(libs.bundles.ktor)

            // Koin DI
            implementation(libs.koin.core)
            implementation(libs.koin.compose)

            // Room Database
            implementation(libs.androidx.room.runtime)

            // DateTime
            implementation("org.jetbrains.kotlinx:kotlinx-datetime:0.5.0")

            // QR Code Generation (ZXing)
            implementation("com.google.zxing:core:3.5.3")

            // Coroutines
            implementation("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.8.0")

            // Kotlin Serialization
            implementation("org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.3")

            // Peekaboo для работы с изображениями
            implementation(libs.bundles.peekaboo)
        }
    }
}

android {
    namespace = "org.pgk.food"
    compileSdk = 36

    defaultConfig {
        applicationId = "org.pgk.food"
        minSdk = 24
        targetSdk = 36
        versionCode = 1
        versionName = "1.0"
    }

    packaging {
        resources {
            excludes += "/META-INF/{AL2.0,LGPL2.1}"
        }
    }

    buildTypes {
        getByName("release") {
            isMinifyEnabled = false
        }
    }

    compileOptions {
        sourceCompatibility = JavaVersion.VERSION_11
        targetCompatibility = JavaVersion.VERSION_11
    }
}

dependencies {
    debugImplementation(compose.uiTooling)

    // Room KSP
    ksp(libs.androidx.room.compiler)
}

room {
    schemaDirectory("$projectDir/schemas")
}

# --- КОНЕЦ ФАЙЛА: composeApp/build.gradle.kts --- 


# ==============================================================================
# Файл: composeApp/src/commonTest/kotlin/org/pgk/food/ComposeAppCommonTest.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonTest/kotlin/org/pgk/food/ComposeAppCommonTest.kt
# ==============================================================================

package org.pgk.food

import kotlin.test.Test
import kotlin.test.assertEquals

class ComposeAppCommonTest {

    @Test
    fun example() {
        assertEquals(3, 1 + 2)
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonTest/kotlin/org/pgk/food/ComposeAppCommonTest.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/App.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/App.kt
# ==============================================================================

package org.pgk.food

import androidx.compose.foundation.layout.Box
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.Surface
import androidx.compose.material3.Text
import androidx.compose.runtime.Composable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import org.pgk.food.ui.theme.AppTheme

@Composable
fun App() {
    AppTheme {
        Surface(
            modifier = Modifier.fillMaxSize(),
            color = MaterialTheme.colorScheme.background
        ) {
            Box(contentAlignment = Alignment.Center) {
                Text(
                    text = "Питание запущено!",
                    style = MaterialTheme.typography.displayMedium,
                    color = MaterialTheme.colorScheme.primary
                )
            }
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/App.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/Greeting.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/Greeting.kt
# ==============================================================================

package org.pgk.food

class Greeting {
    private val platform = getPlatform()

    fun greet(): String {
        return "Hello, ${platform.name}!"
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/Greeting.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/Platform.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/Platform.kt
# ==============================================================================

package org.pgk.food

interface Platform {
    val name: String
}

expect fun getPlatform(): Platform

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/Platform.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/auth/LoginScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/auth/LoginScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.auth

import androidx.compose.foundation.layout.*
import androidx.compose.material3.*
import androidx.compose.runtime.*
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.text.input.PasswordVisualTransformation
import androidx.compose.ui.unit.dp
import cafe.adriel.voyager.core.model.ScreenModel
import cafe.adriel.voyager.core.model.screenModelScope
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.koin.koinScreenModel
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow
import kotlinx.coroutines.delay
import kotlinx.coroutines.flow.MutableStateFlow
import kotlinx.coroutines.flow.asStateFlow
import kotlinx.coroutines.launch
import org.pgk.food.domain.model.Role
import org.pgk.food.presentation.navigation.navigateToHome

class LoginScreen : Screen {
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow
        val viewModel = koinScreenModel<LoginViewModel>()
        val state by viewModel.state.collectAsState()

        Box(modifier = Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {
            Card(
                modifier = Modifier.fillMaxWidth().padding(24.dp),
                colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.surface)
            ) {
                Column(
                    modifier = Modifier.padding(24.dp),
                    horizontalAlignment = Alignment.CenterHorizontally,
                    verticalArrangement = Arrangement.spacedBy(16.dp)
                ) {
                    Text("Вход в систему", style = MaterialTheme.typography.headlineSmall)

                    OutlinedTextField(
                        value = state.login,
                        onValueChange = viewModel::onLoginChange,
                        label = { Text("Логин") },
                        modifier = Modifier.fillMaxWidth(),
                        singleLine = true
                    )

                    OutlinedTextField(
                        value = state.password,
                        onValueChange = viewModel::onPasswordChange,
                        label = { Text("Пароль") },
                        visualTransformation = PasswordVisualTransformation(),
                        modifier = Modifier.fillMaxWidth(),
                        singleLine = true
                    )

                    if (state.error != null) {
                        Text(state.error!!, color = MaterialTheme.colorScheme.error)
                    }

                    Button(
                        onClick = {
                            viewModel.login { roles ->
                                navigator.navigateToHome(roles)
                            }
                        },
                        modifier = Modifier.fillMaxWidth().height(50.dp),
                        enabled = !state.isLoading
                    ) {
                        if (state.isLoading) CircularProgressIndicator(color = MaterialTheme.colorScheme.onPrimary)
                        else Text("Войти")
                    }
                }
            }
        }
    }
}

data class LoginState(
    val login: String = "",
    val password: String = "",
    val isLoading: Boolean = false,
    val error: String? = null
)

class LoginViewModel : ScreenModel {
    private val _state = MutableStateFlow(LoginState())
    val state = _state.asStateFlow()

    fun onLoginChange(value: String) { _state.value = _state.value.copy(login = value) }
    fun onPasswordChange(value: String) { _state.value = _state.value.copy(password = value) }

    fun login(onSuccess: (List<Role>) -> Unit) {
        screenModelScope.launch {
            _state.value = _state.value.copy(isLoading = true, error = null)
            delay(1000) // Имитация сети

            // ПРОСТОЙ ХАРДКОД ДЛЯ ТЕСТА
            val login = _state.value.login.lowercase().trim()
            val roles = when {
                login.contains("admin") -> listOf(Role.ADMIN)
                login.contains("cook") -> listOf(Role.CHEF)
                login.contains("curator") -> listOf(Role.CURATOR)
                login.contains("reg") -> listOf(Role.REGISTRAR)
                else -> listOf(Role.STUDENT) // По дефолту студент
            }

            _state.value = _state.value.copy(isLoading = false)
            onSuccess(roles)
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/auth/LoginScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/auth/LoginViewModel.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/auth/LoginViewModel.kt
# ==============================================================================

package org.pgk.food.presentation.screens.auth

import cafe.adriel.voyager.core.model.ScreenModel
import cafe.adriel.voyager.core.model.screenModelScope
import kotlinx.coroutines.flow.MutableStateFlow
import kotlinx.coroutines.flow.StateFlow
import kotlinx.coroutines.flow.asStateFlow
import kotlinx.coroutines.launch
import org.pgk.food.domain.model.User
import org.pgk.food.domain.usecase.LoginUseCase

data class LoginState(
    val login: String = "",
    val password: String = "",
    val isLoading: Boolean = false,
    val error: String? = null,
    val user: User? = null
)

class LoginViewModel(
    private val loginUseCase: LoginUseCase
) : ScreenModel {
    private val _state = MutableStateFlow(LoginState())
    val state: StateFlow<LoginState> = _state.asStateFlow()

    fun updateLogin(login: String) { _state.value = _state.value.copy(login = login, error = null) }
    fun updatePassword(password: String) { _state.value = _state.value.copy(password = password, error = null) }

    fun login() {
        if (_state.value.login.isBlank()) return
        screenModelScope.launch {
            _state.value = _state.value.copy(isLoading = true)
            loginUseCase(_state.value.login, _state.value.password)
                .onSuccess { user -> _state.value = _state.value.copy(isLoading = false, user = user) }
                .onFailure { e -> _state.value = _state.value.copy(isLoading = false, error = e.message) }
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/auth/LoginViewModel.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/common/Stubs.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/common/Stubs.kt
# ==============================================================================

package org.pgk.food.presentation.screens.common

import androidx.compose.foundation.layout.*
import androidx.compose.material3.*
import androidx.compose.runtime.Composable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow
import org.jetbrains.compose.resources.painterResource
import org.pgk.food.resources.Res
import org.pgk.food.resources.*

class RosterScreen : Screen {
    @OptIn(ExperimentalMaterial3Api::class)
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow
        Scaffold(
            topBar = {
                TopAppBar(
                    title = { Text("Табель питания") },
                    navigationIcon = {
                        IconButton(onClick = { navigator.pop() }) {
                            Icon(painterResource(Res.drawable.ic_arrow_left), "Назад")
                        }
                    }
                )
            }
        ) { padding ->
            Box(modifier = Modifier.fillMaxSize().padding(padding), contentAlignment = Alignment.Center) {
                Text("Табель питания (TODO)")
            }
        }
    }
}

class GroupsScreen : Screen {
    @OptIn(ExperimentalMaterial3Api::class)
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow
        Scaffold(
            topBar = {
                TopAppBar(
                    title = { Text("Группы") },
                    navigationIcon = {
                        IconButton(onClick = { navigator.pop() }) {
                            Icon(painterResource(Res.drawable.ic_arrow_left), "Назад")
                        }
                    }
                )
            }
        ) { padding ->
            Box(modifier = Modifier.fillMaxSize().padding(padding), contentAlignment = Alignment.Center) {
                Text("Список групп (TODO)")
            }
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/common/Stubs.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/AdminDashboard.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/AdminDashboard.kt
# ==============================================================================

package org.pgk.food.presentation.screens.admin

class AdminDashboard {
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/AdminDashboard.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/AdminDashboardScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/AdminDashboardScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.admin

import androidx.compose.foundation.layout.*
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.foundation.lazy.grid.GridCells
import androidx.compose.foundation.lazy.grid.LazyVerticalGrid
import androidx.compose.foundation.lazy.grid.items
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.material3.*
import androidx.compose.runtime.*
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.graphics.painter.Painter
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.unit.dp
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.koin.koinScreenModel
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow

// Импорты навигации и экранов
import org.pgk.food.presentation.navigation.logout
import org.pgk.food.presentation.screens.registrar.CreateUserScreen
import org.pgk.food.presentation.screens.registrar.GroupsScreen
import org.pgk.food.presentation.screens.common.RosterScreen
// import org.pgk.food.presentation.screens.cook.QRScannerScreen // Раскомментируй, когда создашь файл

// Ресурсы
import org.jetbrains.compose.resources.painterResource
import org.pgk.food.resources.Res
import org.pgk.food.resources.* // Импортирует все иконки

class AdminDashboardScreen : Screen {
    @OptIn(ExperimentalMaterial3Api::class)
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow
        val viewModel = koinScreenModel<AdminViewModel>()
        val state by viewModel.state.collectAsState()

        Scaffold(
            topBar = {
                TopAppBar(
                    title = { Text("Панель администратора") },
                    colors = TopAppBarDefaults.topAppBarColors(
                        containerColor = MaterialTheme.colorScheme.primaryContainer,
                        titleContentColor = MaterialTheme.colorScheme.onPrimaryContainer
                    ),
                    actions = {
                        IconButton(onClick = { navigator.push(ReportsScreen()) }) {
                            Icon(painterResource(Res.drawable.ic_document), "Отчёты")
                        }
                        IconButton(onClick = {
                            viewModel.logout()
                            navigator.logout()
                        }) {
                            Icon(painterResource(Res.drawable.ic_logout), "Выход")
                        }
                    }
                )
            }
        ) { padding ->
            AdminDashboardContent(
                state = state,
                onActionClick = { action ->
                    when (action) {
                        AdminAction.CREATE_USER -> navigator.push(CreateUserScreen())
                        AdminAction.MANAGE_GROUPS -> navigator.push(GroupsScreen())
                        AdminAction.SCAN_QR -> { /* navigator.push(QRScannerScreen()) */ }
                        AdminAction.MANAGE_ROSTER -> navigator.push(RosterScreen())
                        AdminAction.VIEW_REPORTS -> navigator.push(ReportsScreen())
                        AdminAction.SETTINGS -> navigator.push(SettingsScreen())
                    }
                },
                modifier = Modifier.padding(padding)
            )
        }
    }
}

@Composable
fun AdminDashboardContent(
    state: AdminDashboardState,
    onActionClick: (AdminAction) -> Unit,
    modifier: Modifier = Modifier
) {
    LazyColumn(
        modifier = modifier.fillMaxSize().padding(16.dp),
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        // Statistics
        item { Text("Статистика", style = MaterialTheme.typography.titleLarge, fontWeight = FontWeight.Bold) }

        item {
            Row(modifier = Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.spacedBy(12.dp)) {
                StatCard(
                    title = "Всего студентов",
                    value = state.totalStudents.toString(),
                    icon = painterResource(Res.drawable.ic_users), // Используем users
                    color = MaterialTheme.colorScheme.primaryContainer,
                    modifier = Modifier.weight(1f)
                )
                StatCard(
                    title = "Активных групп",
                    value = state.totalGroups.toString(),
                    icon = painterResource(Res.drawable.ic_users),
                    color = MaterialTheme.colorScheme.secondaryContainer,
                    modifier = Modifier.weight(1f)
                )
            }
        }

        item {
            Row(modifier = Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.spacedBy(12.dp)) {
                StatCard(
                    title = "Выдано сегодня",
                    value = state.mealsToday.toString(),
                    icon = painterResource(Res.drawable.ic_check_circle), // Или ic_ticket если скачал
                    color = MaterialTheme.colorScheme.tertiaryContainer,
                    modifier = Modifier.weight(1f)
                )
                StatCard(
                    title = "За неделю",
                    value = state.mealsWeek.toString(),
                    icon = painterResource(Res.drawable.ic_calendar_edit),
                    color = MaterialTheme.colorScheme.errorContainer,
                    modifier = Modifier.weight(1f)
                )
            }
        }

        // Quick Actions
        item {
            Spacer(Modifier.height(8.dp))
            Text("Быстрые действия", style = MaterialTheme.typography.titleLarge, fontWeight = FontWeight.Bold)
        }

        item {
            LazyVerticalGrid(
                columns = GridCells.Fixed(2),
                modifier = Modifier.fillMaxWidth().height(400.dp),
                horizontalArrangement = Arrangement.spacedBy(12.dp),
                verticalArrangement = Arrangement.spacedBy(12.dp)
            ) {
                items(AdminAction.values()) { action ->
                    AdminActionCard(action = action, onClick = { onActionClick(action) })
                }
            }
        }
    }
}

@Composable
fun StatCard(
    title: String,
    value: String,
    icon: Painter,
    color: Color,
    modifier: Modifier = Modifier
) {
    Card(modifier = modifier, colors = CardDefaults.cardColors(containerColor = color)) {
        Column(
            modifier = Modifier.fillMaxWidth().padding(16.dp),
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            Icon(icon, null, modifier = Modifier.size(32.dp))
            Spacer(Modifier.height(8.dp))
            Text(value, style = MaterialTheme.typography.headlineMedium, fontWeight = FontWeight.Bold)
            Text(title, style = MaterialTheme.typography.bodySmall, color = MaterialTheme.colorScheme.onSurfaceVariant)
        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun AdminActionCard(action: AdminAction, onClick: () -> Unit) {
    Card(
        onClick = onClick,
        modifier = Modifier.fillMaxWidth().height(120.dp),
        colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.surfaceVariant),
        shape = RoundedCornerShape(16.dp)
    ) {
        Column(
            modifier = Modifier.fillMaxSize().padding(16.dp),
            horizontalAlignment = Alignment.CenterHorizontally,
            verticalArrangement = Arrangement.Center
        ) {
            Icon(
                painter = painterResource(action.iconRes),
                contentDescription = null,
                modifier = Modifier.size(40.dp),
                tint = MaterialTheme.colorScheme.primary
            )
            Spacer(Modifier.height(8.dp))
            Text(action.title, style = MaterialTheme.typography.titleSmall, fontWeight = FontWeight.SemiBold)
        }
    }
}

// Переделанный Enum для работы с ресурсами
enum class AdminAction(
    val title: String,
    val iconRes: org.jetbrains.compose.resources.DrawableResource
) {
    CREATE_USER("Добавить пользователя", Res.drawable.ic_user_add),
    MANAGE_GROUPS("Управление группами", Res.drawable.ic_users),
    SCAN_QR("Сканировать QR", Res.drawable.ic_qr_code),
    MANAGE_ROSTER("Табель питания", Res.drawable.ic_calendar_edit),
    VIEW_REPORTS("Отчёты", Res.drawable.ic_document),
    SETTINGS("Настройки", Res.drawable.ic_settings)
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/AdminDashboardScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/AdminViewModel.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/AdminViewModel.kt
# ==============================================================================

package org.pgk.food.presentation.screens.admin

import cafe.adriel.voyager.core.model.ScreenModel
import kotlinx.coroutines.flow.MutableStateFlow
import kotlinx.coroutines.flow.StateFlow
import kotlinx.coroutines.flow.asStateFlow

data class AdminDashboardState(
    val totalStudents: Int = 0,
    val totalGroups: Int = 0,
    val mealsToday: Int = 0,
    val mealsWeek: Int = 0
)

class AdminViewModel : ScreenModel {
    private val _state = MutableStateFlow(
        AdminDashboardState(
            totalStudents = 156,
            totalGroups = 8,
            mealsToday = 89,
            mealsWeek = 512
        )
    )
    val state: StateFlow<AdminDashboardState> = _state.asStateFlow()

    fun logout() {
        // Очистка токенов или сессии
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/AdminViewModel.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/RegisterScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/RegisterScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.admin

class RegisterScreen {
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/RegisterScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/ReportsScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/ReportsScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.admin

import androidx.compose.foundation.layout.*
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.material3.*
import androidx.compose.runtime.Composable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.painter.Painter
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.unit.dp
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow
import org.jetbrains.compose.resources.painterResource
import org.pgk.food.resources.Res
import org.pgk.food.resources.*

class ReportsScreen : Screen {
    @OptIn(ExperimentalMaterial3Api::class)
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow

        Scaffold(
            topBar = {
                TopAppBar(
                    title = { Text("Отчёты") },
                    navigationIcon = {
                        IconButton(onClick = { navigator.pop() }) {
                            Icon(painterResource(Res.drawable.ic_arrow_left), "Назад")
                        }
                    }
                )
            }
        ) { padding ->
            LazyColumn(
                modifier = Modifier.fillMaxSize().padding(padding).padding(16.dp),
                verticalArrangement = Arrangement.spacedBy(12.dp)
            ) {
                item { Text("Доступные отчёты", style = MaterialTheme.typography.titleLarge, fontWeight = FontWeight.Bold) }

                item { ReportCard("Дневной отчёт", "Статистика питания за день", painterResource(Res.drawable.ic_calendar_edit)) {} }
                item { ReportCard("Недельный отчёт", "Статистика за неделю", painterResource(Res.drawable.ic_chart_bar)) {} }
                item { ReportCard("Отчёт по группам", "Сравнение групп", painterResource(Res.drawable.ic_users)) {} }
                item { ReportCard("Экспорт в CSV", "Выгрузка данных", painterResource(Res.drawable.ic_upload)) {} }
            }
        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun ReportCard(title: String, description: String, icon: Painter, onClick: () -> Unit) {
    Card(
        onClick = onClick,
        modifier = Modifier.fillMaxWidth(),
        colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.secondaryContainer)
    ) {
        Row(modifier = Modifier.fillMaxWidth().padding(16.dp), verticalAlignment = Alignment.CenterVertically) {
            Icon(icon, null, modifier = Modifier.size(48.dp), tint = MaterialTheme.colorScheme.onSecondaryContainer)
            Spacer(Modifier.width(16.dp))
            Column(modifier = Modifier.weight(1f)) {
                Text(title, style = MaterialTheme.typography.titleMedium, fontWeight = FontWeight.Bold)
                Text(description, style = MaterialTheme.typography.bodyMedium, color = MaterialTheme.colorScheme.onSurfaceVariant)
            }
            Icon(painterResource(Res.drawable.ic_arrow_left), null) // Используем стрелку (можно повернуть модификатором rotate(180f))
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/ReportsScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/SettingsScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/SettingsScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.admin

import androidx.compose.foundation.layout.*
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.material3.*
import androidx.compose.runtime.Composable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.painter.Painter
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.unit.dp
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow
import org.jetbrains.compose.resources.painterResource
import org.pgk.food.resources.Res
import org.pgk.food.resources.*

class SettingsScreen : Screen {
    @OptIn(ExperimentalMaterial3Api::class)
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow

        Scaffold(
            topBar = {
                TopAppBar(
                    title = { Text("Настройки") },
                    navigationIcon = {
                        IconButton(onClick = { navigator.pop() }) {
                            Icon(painterResource(Res.drawable.ic_arrow_left), "Назад")
                        }
                    }
                )
            }
        ) { padding ->
            LazyColumn(
                modifier = Modifier.fillMaxSize().padding(padding).padding(16.dp),
                verticalArrangement = Arrangement.spacedBy(8.dp)
            ) {
                item { Text("Настройки системы", style = MaterialTheme.typography.titleLarge, fontWeight = FontWeight.Bold) }

                item { SettingItem("URL сервера", "https://food.pgk.apis.alspio.com", painterResource(Res.drawable.ic_cloud)) }
                item { SettingItem("Период валидности QR", "30 секунд", painterResource(Res.drawable.ic_clock)) }
                item { SettingItem("Автосинхронизация", "Включена", painterResource(Res.drawable.ic_sync)) }

                item { Spacer(Modifier.height(16.dp)); Text("О приложении", style = MaterialTheme.typography.titleMedium, fontWeight = FontWeight.Bold) }

                item {
                    Card(modifier = Modifier.fillMaxWidth()) {
                        Column(modifier = Modifier.padding(16.dp)) {
                            Text("Версия: 1.0.0")
                            Text("Сборка: Debug")
                            Text("Kotlin Multiplatform")
                        }
                    }
                }
            }
        }
    }
}

@Composable
fun SettingItem(title: String, value: String, icon: Painter) {
    Card(modifier = Modifier.fillMaxWidth()) {
        Row(modifier = Modifier.fillMaxWidth().padding(16.dp), verticalAlignment = Alignment.CenterVertically) {
            Icon(icon, null)
            Spacer(Modifier.width(16.dp))
            Column(modifier = Modifier.weight(1f)) {
                Text(title, style = MaterialTheme.typography.titleSmall, fontWeight = FontWeight.SemiBold)
                Text(value, style = MaterialTheme.typography.bodySmall, color = MaterialTheme.colorScheme.onSurfaceVariant)
            }
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/admin/SettingsScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/curator/CuratorHomeScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/curator/CuratorHomeScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.curator

import androidx.compose.foundation.layout.*
import androidx.compose.material3.*
import androidx.compose.runtime.Composable
import androidx.compose.ui.Modifier
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.unit.dp
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow

// Импорты компонентов и навигации
import org.pgk.food.presentation.components.QuickActionCard
import org.pgk.food.presentation.navigation.logout
import org.pgk.food.presentation.screens.common.RosterScreen // Убедись, что RosterScreen перенесен в common или импортирован верно

// Твои ресурсы
import org.jetbrains.compose.resources.painterResource
import org.pgk.food.resources.Res
import org.pgk.food.resources.ic_logout
import org.pgk.food.resources.ic_calendar_edit
import org.pgk.food.resources.ic_table_cells
import org.pgk.food.resources.ic_chart_bar

class CuratorHomeScreen : Screen {
    @OptIn(ExperimentalMaterial3Api::class)
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow

        Scaffold(
            topBar = {
                TopAppBar(
                    title = { Text("Куратор") },
                    colors = TopAppBarDefaults.topAppBarColors(
                        containerColor = MaterialTheme.colorScheme.primaryContainer
                    ),
                    actions = {
                        IconButton(onClick = { navigator.logout() }) {
                            Icon(painterResource(Res.drawable.ic_logout), "Выход")
                        }
                    }
                )
            },
            floatingActionButton = {
                ExtendedFloatingActionButton(
                    onClick = { navigator.push(RosterScreen()) },
                    icon = { Icon(painterResource(Res.drawable.ic_calendar_edit), null) },
                    text = { Text("Заполнить табель") }
                )
            }
        ) { padding ->
            Column(
                modifier = Modifier
                    .fillMaxSize()
                    .padding(padding)
                    .padding(16.dp)
            ) {
                // Карточка группы (Static info пока что)
                Card(
                    modifier = Modifier.fillMaxWidth(),
                    colors = CardDefaults.cardColors(
                        containerColor = MaterialTheme.colorScheme.tertiaryContainer
                    )
                ) {
                    Column(modifier = Modifier.padding(16.dp)) {
                        Text(
                            "Моя группа",
                            style = MaterialTheme.typography.titleLarge,
                            fontWeight = FontWeight.Bold
                        )
                        Spacer(Modifier.height(8.dp))
                        Text(
                            "ИС-22-1", // Тут потом привяжем данные из ViewModel
                            style = MaterialTheme.typography.headlineMedium
                        )
                        Text(
                            "24 студента",
                            style = MaterialTheme.typography.bodyMedium
                        )
                    }
                }

                Spacer(Modifier.height(24.dp))

                // Быстрые действия
                Row(
                    modifier = Modifier.fillMaxWidth(),
                    horizontalArrangement = Arrangement.spacedBy(12.dp)
                ) {
                    QuickActionCard(
                        title = "Табель",
                        iconPainter = painterResource(Res.drawable.ic_table_cells),
                        onClick = { navigator.push(RosterScreen()) },
                        modifier = Modifier.weight(1f)
                    )
                    QuickActionCard(
                        title = "Статистика",
                        iconPainter = painterResource(Res.drawable.ic_chart_bar),
                        onClick = { /* TODO: Экран статистики */ },
                        modifier = Modifier.weight(1f)
                    )
                }
            }
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/curator/CuratorHomeScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/student/ProfileScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/student/ProfileScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.student

import androidx.compose.foundation.layout.*
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.filled.ArrowBack
import androidx.compose.material3.*
import androidx.compose.runtime.Composable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow

class ProfileScreen : Screen {
    @OptIn(ExperimentalMaterial3Api::class)
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow
        Scaffold(
            topBar = {
                TopAppBar(
                    title = { Text("Профиль") },
                    navigationIcon = {
                        IconButton(onClick = { navigator.pop() }) {
                            Icon(Icons.Default.ArrowBack, "Назад")
                        }
                    }
                )
            }
        ) { padding ->
            Box(Modifier.fillMaxSize().padding(padding), contentAlignment = Alignment.Center) {
                Text("Профиль студента (TODO)")
            }
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/student/ProfileScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/student/QRCodeScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/student/QRCodeScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.student

import androidx.compose.foundation.Canvas
import androidx.compose.foundation.background
import androidx.compose.foundation.layout.*
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.filled.ArrowBack
import androidx.compose.material.icons.filled.Timer
import androidx.compose.material3.*
import androidx.compose.runtime.*
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.graphics.Path
import androidx.compose.ui.graphics.drawscope.Fill
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.unit.dp
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.koin.koinScreenModel
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow
import kotlinx.coroutines.delay
import org.pgk.food.domain.model.Ticket
import org.pgk.food.utils.QRCodeBitmap

class QRCodeScreen(private val ticket: Ticket) : Screen {
    @OptIn(ExperimentalMaterial3Api::class)
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow
        val viewModel = koinScreenModel<StudentHomeViewModel>() // Используем ту же VM для генерации

        LaunchedEffect(Unit) {
            viewModel.generateQR(ticket.mealType)
        }

        val qrState by viewModel.qrState.collectAsState()

        Scaffold(
            topBar = {
                TopAppBar(
                    title = { Text("QR Код") },
                    navigationIcon = {
                        IconButton(onClick = { navigator.pop() }) {
                            Icon(Icons.Default.ArrowBack, "Назад")
                        }
                    }
                )
            }
        ) { padding ->
            QRCodeContent(
                qrState = qrState,
                ticket = ticket,
                onRefresh = { viewModel.generateQR(ticket.mealType) },
                modifier = Modifier.padding(padding)
            )
        }
    }
}

@Composable
fun QRCodeContent(
    qrState: QRState,
    ticket: Ticket,
    onRefresh: () -> Unit,
    modifier: Modifier = Modifier
) {
    LaunchedEffect(Unit) {
        while (true) {
            delay(30_000)
            onRefresh()
        }
    }
    Column(modifier.fillMaxSize().padding(24.dp), horizontalAlignment = Alignment.CenterHorizontally) {
        Text(ticket.mealType.name, style = MaterialTheme.typography.headlineMedium)
        Text(ticket.date)
        Spacer(Modifier.height(32.dp))
        Card(Modifier.size(300.dp)) {
            Box(Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {
                if (qrState.qrBitmap != null) {
                    QRCodeImage(qrState.qrBitmap!!)
                } else {
                    CircularProgressIndicator()
                }
            }
        }
        Spacer(Modifier.height(24.dp))
        // Таймер упрощенно
        Text("Обновится через 30 сек")
    }
}

@Composable
fun QRCodeImage(qrBitmap: QRCodeBitmap) {
    // Рисуем QR через Canvas, так как ImageBitmap требует платформенного кода
    Canvas(modifier = Modifier.fillMaxSize().padding(16.dp)) {
        val matrix = qrBitmap.bitMatrix
        val width = matrix.width
        val height = matrix.height
        val cellWidth = size.width / width
        val cellHeight = size.height / height

        for (x in 0 until width) {
            for (y in 0 until height) {
                if (matrix[x, y]) {
                    drawRect(
                        color = Color.Black,
                        topLeft = androidx.compose.ui.geometry.Offset(x * cellWidth, y * cellHeight),
                        size = androidx.compose.ui.geometry.Size(cellWidth + 1, cellHeight + 1) // +1 чтобы убрать щели
                    )
                }
            }
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/student/QRCodeScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/student/StudentHomeScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/student/StudentHomeScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.student

import androidx.compose.foundation.background
import androidx.compose.foundation.layout.*
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.foundation.lazy.items
import androidx.compose.foundation.shape.CircleShape
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.filled.*
import androidx.compose.material3.*
import androidx.compose.runtime.*
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.draw.clip
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.unit.dp
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.koin.koinScreenModel // Исправил на koinScreenModel
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow
import org.pgk.food.domain.model.MealType
import org.pgk.food.domain.model.Ticket
import org.pgk.food.presentation.navigation.logout

class StudentHomeScreen : Screen {
    @OptIn(ExperimentalMaterial3Api::class)
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow
        val viewModel = koinScreenModel<StudentHomeViewModel>()
        val state by viewModel.state.collectAsState()

        Scaffold(
            topBar = {
                TopAppBar(
                    title = { Text("Мои талоны") },
                    colors = TopAppBarDefaults.topAppBarColors(
                        containerColor = MaterialTheme.colorScheme.primaryContainer
                    ),
                    actions = {
                        IconButton(onClick = { navigator.push(ProfileScreen()) }) {
                            Icon(Icons.Default.Person, "Профиль")
                        }
                        IconButton(onClick = {
                            viewModel.logout()
                            navigator.logout()
                        }) {
                            Icon(Icons.Default.ExitToApp, "Выход")
                        }
                    }
                )
            }
        ) { padding ->
            StudentHomeContent(
                state = state,
                onTicketClick = { ticket -> navigator.push(QRCodeScreen(ticket)) },
                modifier = Modifier.padding(padding)
            )
        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun StudentHomeContent(
    state: StudentHomeState,
    onTicketClick: (Ticket) -> Unit,
    modifier: Modifier = Modifier
) {
    Box(modifier = modifier.fillMaxSize()) {
        when {
            state.isLoading -> CircularProgressIndicator(Modifier.align(Alignment.Center))
            state.error != null -> Text(state.error!!, Modifier.align(Alignment.Center), color = MaterialTheme.colorScheme.error)
            state.tickets.isEmpty() -> {
                Column(Modifier.align(Alignment.Center), horizontalAlignment = Alignment.CenterHorizontally) {
                    Icon(Icons.Default.Receipt, null, Modifier.size(64.dp))
                    Text("Нет талонов")
                }
            }
            else -> {
                LazyColumn(Modifier.fillMaxSize(), contentPadding = PaddingValues(16.dp), verticalArrangement = Arrangement.spacedBy(12.dp)) {
                    items(state.tickets) { ticket ->
                        TicketCard(ticket = ticket, onClick = { onTicketClick(ticket) })
                    }
                }
            }
        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun TicketCard(ticket: Ticket, onClick: () -> Unit) {
    Card(onClick = onClick, modifier = Modifier.fillMaxWidth()) {
        Row(Modifier.padding(16.dp), verticalAlignment = Alignment.CenterVertically) {
            Box(Modifier.size(56.dp).clip(CircleShape).background(MaterialTheme.colorScheme.primary), contentAlignment = Alignment.Center) {
                // Примечание: Icons.Default.Cookie и DinnerDining могут требовать extended библиотеку
                // Если не компилируется, замени на Icons.Default.Star временно
                Icon(Icons.Default.Star, null, tint = Color.White)
            }
            Spacer(Modifier.width(16.dp))
            Column(Modifier.weight(1f)) {
                Text(ticket.mealType.name, fontWeight = FontWeight.Bold)
                Text(ticket.date)
            }
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/student/StudentHomeScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/student/StudentHomeViewModel.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/student/StudentHomeViewModel.kt
# ==============================================================================

package org.pgk.food.presentation.screens.student

import cafe.adriel.voyager.core.model.ScreenModel
import cafe.adriel.voyager.core.model.screenModelScope
import kotlinx.coroutines.delay
import kotlinx.coroutines.flow.MutableStateFlow
import kotlinx.coroutines.flow.StateFlow
import kotlinx.coroutines.flow.asStateFlow
import kotlinx.coroutines.launch
import org.pgk.food.domain.model.MealType
import org.pgk.food.domain.model.Ticket
import org.pgk.food.domain.usecase.GenerateQRUseCase
import org.pgk.food.utils.QRCodeBitmap

data class StudentHomeState(
    val tickets: List<Ticket> = emptyList(),
    val isLoading: Boolean = false,
    val error: String? = null
)

data class QRState(
    val qrBitmap: QRCodeBitmap? = null,
    val isLoading: Boolean = false,
    val error: String? = null
)

class StudentHomeViewModel(
    private val generateQRUseCase: GenerateQRUseCase,
    private val tokenStorage: org.pgk.food.data.repository.TokenStorage, // Добавил storage для ID
    private val ticketRepository: org.pgk.food.data.repository.TicketRepository // Добавил репо
) : ScreenModel {
    private val _state = MutableStateFlow(StudentHomeState())
    val state: StateFlow<StudentHomeState> = _state.asStateFlow()

    private val _qrState = MutableStateFlow(QRState())
    val qrState: StateFlow<QRState> = _qrState.asStateFlow()

    init {
        loadTickets()
    }

    private fun loadTickets() {
        screenModelScope.launch {
            _state.value = _state.value.copy(isLoading = true)
            delay(500) // Mock loading
            _state.value = _state.value.copy(
                isLoading = false,
                tickets = listOf(
                    Ticket("1", "user1", MealType.BREAKFAST, "2025-12-14", false),
                    Ticket("2", "user1", MealType.LUNCH, "2025-12-14", false),
                    Ticket("3", "user1", MealType.DINNER, "2025-12-14", false)
                )
            )
        }
    }

    fun generateQR(mealType: MealType) {
        screenModelScope.launch {
            _qrState.value = _qrState.value.copy(isLoading = true)
            try {
                // В реале брать ID и ключ из User/TokenStorage
                val qrBitmap = generateQRUseCase(
                    userId = "temp_user_id",
                    mealType = mealType,
                    privateKey = "temp_private_key",
                    serverTimeDelta = 0
                )
                _qrState.value = _qrState.value.copy(isLoading = false, qrBitmap = qrBitmap)
            } catch (e: Exception) {
                _qrState.value = _qrState.value.copy(isLoading = false, error = e.message)
            }
        }
    }

    fun logout() {
        tokenStorage.clearToken()
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/student/StudentHomeViewModel.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/registrar/CreateUserScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/registrar/CreateUserScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.registrar

import androidx.compose.foundation.layout.*
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.material3.*
import androidx.compose.runtime.*
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.unit.dp
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.koin.koinScreenModel
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow
import org.jetbrains.compose.resources.painterResource
import org.pgk.food.domain.model.Role
import org.pgk.food.presentation.components.CreatedUserDialog

import org.pgk.food.resources.Res
import org.pgk.food.resources.*

class CreateUserScreen : Screen {
    @OptIn(ExperimentalMaterial3Api::class)
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow
        val viewModel = koinScreenModel<RegistrarViewModel>()
        val state by viewModel.createUserState.collectAsState()

        Scaffold(
            topBar = {
                TopAppBar(
                    title = { Text("Добавить пользователя") },
                    navigationIcon = {
                        IconButton(onClick = { navigator.pop() }) {
                            Icon(painterResource(Res.drawable.ic_arrow_left), "Назад")
                        }
                    }
                )
            }
        ) { padding ->
            CreateUserContent(
                state = state,
                onNameChange = viewModel::updateName,
                onSurnameChange = viewModel::updateSurname,
                onFatherNameChange = viewModel::updateFatherName,
                onRoleToggle = viewModel::toggleRole,
                onGroupIdChange = viewModel::updateGroupId,
                onCreateClick = viewModel::createUser,
                modifier = Modifier.padding(padding)
            )
        }

        // Success Dialog
        state.createdUser?.let { user ->
            CreatedUserDialog(
                user = user,
                onDismiss = {
                    viewModel.clearCreatedUser()
                    navigator.pop()
                }
            )
        }
    }
}

@Composable
fun CreateUserContent(
    state: CreateUserState,
    onNameChange: (String) -> Unit,
    onSurnameChange: (String) -> Unit,
    onFatherNameChange: (String) -> Unit,
    onRoleToggle: (Role) -> Unit,
    onGroupIdChange: (String) -> Unit,
    onCreateClick: () -> Unit,
    modifier: Modifier = Modifier
) {
    LazyColumn(
        modifier = modifier.fillMaxSize().padding(16.dp),
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        item {
            Text("Личные данные", style = MaterialTheme.typography.titleMedium, fontWeight = FontWeight.Bold)
        }
        item {
            OutlinedTextField(
                value = state.surname,
                onValueChange = onSurnameChange,
                label = { Text("Фамилия") },
                modifier = Modifier.fillMaxWidth(),
                singleLine = true
            )
        }
        item {
            OutlinedTextField(
                value = state.name,
                onValueChange = onNameChange,
                label = { Text("Имя") },
                modifier = Modifier.fillMaxWidth(),
                singleLine = true
            )
        }
        item {
            OutlinedTextField(
                value = state.fatherName,
                onValueChange = onFatherNameChange,
                label = { Text("Отчество") },
                modifier = Modifier.fillMaxWidth(),
                singleLine = true
            )
        }
        item {
            Spacer(Modifier.height(8.dp))
            Text("Роли", style = MaterialTheme.typography.titleMedium, fontWeight = FontWeight.Bold)
        }
        item {
            Column(verticalArrangement = Arrangement.spacedBy(8.dp)) {
                listOf(
                    Role.STUDENT to "Студент",
                    Role.CURATOR to "Куратор",
                    Role.CHEF to "Повар",
                    Role.REGISTRAR to "Регистратор",
                    Role.ADMIN to "Администратор"
                ).forEach { (role, label) ->
                    Row(
                        modifier = Modifier.fillMaxWidth(),
                        verticalAlignment = Alignment.CenterVertically
                    ) {
                        Checkbox(
                            checked = state.selectedRoles.contains(role),
                            onCheckedChange = { onRoleToggle(role) }
                        )
                        Text(label, modifier = Modifier.padding(start = 8.dp))
                    }
                }
            }
        }
        if (state.selectedRoles.contains(Role.STUDENT)) {
            item {
                OutlinedTextField(
                    value = state.groupId,
                    onValueChange = onGroupIdChange,
                    label = { Text("ID группы") },
                    modifier = Modifier.fillMaxWidth(),
                    singleLine = true,
                    supportingText = { Text("Опционально для студентов") }
                )
            }
        }
        item {
            Spacer(Modifier.height(16.dp))
            Button(
                onClick = onCreateClick,
                modifier = Modifier.fillMaxWidth().height(56.dp),
                enabled = !state.isLoading && state.isValid,
                shape = RoundedCornerShape(12.dp)
            ) {
                if (state.isLoading) {
                    CircularProgressIndicator(modifier = Modifier.size(24.dp), color = MaterialTheme.colorScheme.onPrimary)
                } else {
                    Text("Создать пользователя")
                }
            }
        }
        state.error?.let { error ->
            item {
                Text(error, color = MaterialTheme.colorScheme.error, style = MaterialTheme.typography.bodyMedium)
            }
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/registrar/CreateUserScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/registrar/RegistrarHomeScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/registrar/RegistrarHomeScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.registrar

import androidx.compose.foundation.layout.*
import androidx.compose.material3.*
import androidx.compose.runtime.Composable
import androidx.compose.ui.Modifier
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.unit.dp
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.koin.koinScreenModel // <-- ВОТ ПРАВИЛЬНЫЙ ИМПОРТ
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow
import org.jetbrains.compose.resources.painterResource
import org.pgk.food.presentation.navigation.logout
import org.pgk.food.presentation.components.QuickActionCard
import org.pgk.food.presentation.screens.common.GroupsScreen

import org.pgk.food.resources.Res
import org.pgk.food.resources.*


class RegistrarHomeScreen : Screen {
    @OptIn(ExperimentalMaterial3Api::class)
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow
        // ИСПРАВЛЕНО: Используем koinScreenModel вместо getScreenModel
        val viewModel = koinScreenModel<RegistrarViewModel>()

        Scaffold(
            topBar = {
                TopAppBar(
                    title = { Text("Регистратор") },
                    colors = TopAppBarDefaults.topAppBarColors(
                        containerColor = MaterialTheme.colorScheme.primaryContainer
                    ),
                    actions = {
                        IconButton(onClick = { navigator.logout() }) {
                            Icon(painterResource(Res.drawable.ic_logout), "Выход")
                        }
                    }
                )
            },
            floatingActionButton = {
                ExtendedFloatingActionButton(
                    onClick = { navigator.push(CreateUserScreen()) },
                    icon = { Icon(painterResource(Res.drawable.ic_user_add), null) },
                    text = { Text("Добавить студента") }
                )
            }
        ) { padding ->
            Box(modifier = Modifier.fillMaxSize().padding(padding)) {
                Column(modifier = Modifier.fillMaxSize().padding(16.dp)) {
                    // Quick Actions
                    Row(
                        modifier = Modifier.fillMaxWidth(),
                        horizontalArrangement = Arrangement.spacedBy(12.dp)
                    ) {
                        QuickActionCard(
                            title = "Группы",
                            iconPainter = painterResource(Res.drawable.ic_users),
                            onClick = { navigator.push(GroupsScreen()) },
                            modifier = Modifier.weight(1f)
                        )
                        QuickActionCard(
                            title = "Импорт CSV",
                            iconPainter = painterResource(Res.drawable.ic_upload),
                            onClick = { /* TODO */ },
                            modifier = Modifier.weight(1f)
                        )
                    }

                    Spacer(Modifier.height(24.dp))

                    Text(
                        "Недавно добавленные",
                        style = MaterialTheme.typography.titleLarge,
                        fontWeight = FontWeight.Bold
                    )

                    Spacer(Modifier.height(12.dp))

                    Text(
                        "Здесь будет список недавно добавленных пользователей",
                        style = MaterialTheme.typography.bodyMedium,
                        color = MaterialTheme.colorScheme.onSurfaceVariant
                    )
                }
            }
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/registrar/RegistrarHomeScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/registrar/RegistrarViewModel.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/registrar/RegistrarViewModel.kt
# ==============================================================================

package org.pgk.food.presentation.screens.registrar

import cafe.adriel.voyager.core.model.ScreenModel
import cafe.adriel.voyager.core.model.screenModelScope
import kotlinx.coroutines.delay
import kotlinx.coroutines.flow.MutableStateFlow
import kotlinx.coroutines.flow.StateFlow
import kotlinx.coroutines.flow.asStateFlow
import kotlinx.coroutines.launch
import org.pgk.food.data.remote.dto.UserCredentialsResponse
import org.pgk.food.domain.model.Role

// Состояние выносим отдельно, чтобы не засорять VM
data class CreateUserState(
    val name: String = "",
    val surname: String = "",
    val fatherName: String = "",
    val selectedRoles: Set<Role> = setOf(Role.STUDENT),
    val groupId: String = "",
    val isLoading: Boolean = false,
    val error: String? = null,
    val createdUser: UserCredentialsResponse? = null
) {
    val isValid: Boolean
        get() = name.isNotBlank() &&
                surname.isNotBlank() &&
                fatherName.isNotBlank() &&
                selectedRoles.isNotEmpty()
}

class RegistrarViewModel : ScreenModel {
    private val _createUserState = MutableStateFlow(CreateUserState())
    val createUserState: StateFlow<CreateUserState> = _createUserState.asStateFlow()

    fun updateName(name: String) {
        _createUserState.value = _createUserState.value.copy(name = name)
    }

    fun updateSurname(surname: String) {
        _createUserState.value = _createUserState.value.copy(surname = surname)
    }

    fun updateFatherName(fatherName: String) {
        _createUserState.value = _createUserState.value.copy(fatherName = fatherName)
    }

    fun toggleRole(role: Role) {
        val current = _createUserState.value.selectedRoles
        _createUserState.value = _createUserState.value.copy(
            selectedRoles = if (current.contains(role)) {
                current - role
            } else {
                current + role
            }
        )
    }

    fun updateGroupId(groupId: String) {
        _createUserState.value = _createUserState.value.copy(groupId = groupId)
    }

    fun createUser() {
        screenModelScope.launch {
            _createUserState.value = _createUserState.value.copy(isLoading = true)

            // Эмуляция запроса. Здесь вставь реальный вызов UseCase
            delay(1000)

            val mockResponse = UserCredentialsResponse(
                userId = "123",
                login = "student123",
                passwordClearText = "temp_password_123",
                fullName = "${_createUserState.value.surname} ${_createUserState.value.name}"
            )

            _createUserState.value = _createUserState.value.copy(
                isLoading = false,
                createdUser = mockResponse
            )
        }
    }

    fun clearCreatedUser() {
        _createUserState.value = CreateUserState()
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/registrar/RegistrarViewModel.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/cook/CookHomeScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/cook/CookHomeScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.cook

import androidx.compose.foundation.layout.*
import androidx.compose.material3.*
import androidx.compose.runtime.Composable
import androidx.compose.ui.Modifier
import androidx.compose.ui.unit.dp
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow
import org.jetbrains.compose.resources.painterResource
import org.pgk.food.presentation.navigation.logout
import org.pgk.food.presentation.components.QuickActionCard
import org.pgk.food.resources.Res
import org.pgk.food.resources.*

class CookHomeScreen : Screen {
    @OptIn(ExperimentalMaterial3Api::class)
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow

        Scaffold(
            topBar = {
                TopAppBar(
                    title = { Text("Столовая (Повар)") },
                    actions = {
                        IconButton(onClick = { navigator.logout() }) {
                            Icon(painterResource(Res.drawable.ic_logout), "Выход")
                        }
                    }
                )
            }
        ) { padding ->
            Column(
                modifier = Modifier
                    .fillMaxSize()
                    .padding(padding)
                    .padding(16.dp),
                verticalArrangement = Arrangement.Center
            ) {
                QuickActionCard(
                    title = "СКАНИРОВАТЬ ТАЛОН",
                    iconPainter = painterResource(Res.drawable.ic_qr_code),
                    onClick = { navigator.push(QRScannerScreen()) },
                    modifier = Modifier.fillMaxWidth().height(150.dp)
                )

                Spacer(Modifier.height(24.dp))

                QuickActionCard(
                    title = "История выдачи",
                    iconPainter = painterResource(Res.drawable.ic_history), // Убедись, что скачал иконку clock -> ic_history
                    onClick = { /* TODO: History Screen */ },
                    modifier = Modifier.fillMaxWidth().height(100.dp)
                )
            }
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/cook/CookHomeScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/cook/HistoryScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/cook/HistoryScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.cook

class HistoryScreen {
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/cook/HistoryScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/cook/QRScannerScreen.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/cook/QRScannerScreen.kt
# ==============================================================================

package org.pgk.food.presentation.screens.cook

import androidx.compose.foundation.background
import androidx.compose.foundation.border
import androidx.compose.foundation.layout.*
import androidx.compose.foundation.shape.CircleShape
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.material3.*
import androidx.compose.runtime.*
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.unit.dp
import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.navigator.LocalNavigator
import cafe.adriel.voyager.navigator.currentOrThrow
import com.preat.peekaboo.ui.camera.CameraMode
import com.preat.peekaboo.ui.camera.PeekabooCamera
import com.preat.peekaboo.ui.camera.rememberPeekabooCameraState
import org.jetbrains.compose.resources.painterResource
import org.pgk.food.resources.Res
import org.pgk.food.resources.ic_arrow_left

class QRScannerScreen : Screen {
    @Composable
    override fun Content() {
        val navigator = LocalNavigator.currentOrThrow
        val cameraState = rememberPeekabooCameraState(onCapture = {})

        // Состояние обработки (чтобы не спамить сканированием одного кода)
        var isProcessing by remember { mutableStateOf(false) }
        var lastScannedCode by remember { mutableStateOf<String?>(null) }
        var scanResult by remember { mutableStateOf<ScanResult?>(null) }

        Box(modifier = Modifier.fillMaxSize().background(Color.Black)) {
            // КАМЕРА (Только если результат еще не показан)
            if (scanResult == null) {
                // Peekaboo Camera не имеет встроенного QR сканера в версии UI 0.5.2 из коробки так просто,
                // НО многие версии поддерживают callback. Если библиотека не поддерживает QR из коробки
                // в этой версии, придется использовать Zxing или натив.
                // ВАЖНО: Предполагаем, что ты найдешь способ подключить анализатор,
                // или используем заглушку для теста, если библиотека только делает фото.

                // Внимание: Peekaboo в основном для фото. Для QR кодов в KMP
                // лучше использовать qr-scanner-kmp или нативный interop.
                // НО, так как времени мало, давай сделаем UI заглушку,
                // которая "сканирует" через 2 секунды (симуляция),
                // если реальная камера не заработает сразу.

                PeekabooCamera(
                    state = cameraState,
                    modifier = Modifier.fillMaxSize(),
                    permissionDeniedContent = {
                        Text("Нужен доступ к камере!", color = Color.White, modifier = Modifier.align(Alignment.Center))
                    }
                )

                // Оверлей сканера
                Box(
                    modifier = Modifier
                        .size(250.dp)
                        .border(2.dp, Color.Green, RoundedCornerShape(12.dp))
                        .align(Alignment.Center)
                )

                // Кнопка-симулятор (для отладки на эмуляторе без камеры)
                Button(
                    onClick = {
                        scanResult = ScanResult.Success("Студент: Иван Иванов")
                    },
                    modifier = Modifier.align(Alignment.BottomCenter).padding(32.dp)
                ) {
                    Text("СИМУЛЯЦИЯ СКАНА")
                }
            }

            // РЕЗУЛЬТАТ СКАНА (Всплывающее окно)
            scanResult?.let { result ->
                AlertDialog(
                    onDismissRequest = { scanResult = null },
                    title = {
                        Text(
                            text = if (result is ScanResult.Success) "УСПЕХ" else "ОШИБКА",
                            color = if (result is ScanResult.Success) Color(0xFF2E7D32) else MaterialTheme.colorScheme.error
                        )
                    },
                    text = {
                        Text(
                            text = if (result is ScanResult.Success) result.studentName else "Талон недействителен",
                            style = MaterialTheme.typography.headlineSmall
                        )
                    },
                    confirmButton = {
                        Button(onClick = { scanResult = null }) {
                            Text("СЛЕДУЮЩИЙ")
                        }
                    }
                )
            }

            // Кнопка назад
            IconButton(
                onClick = { navigator.pop() },
                modifier = Modifier
                    .align(Alignment.TopStart)
                    .padding(16.dp)
                    .background(Color.Black.copy(alpha = 0.5f), CircleShape)
            ) {
                Icon(painterResource(Res.drawable.ic_arrow_left), "Назад", tint = Color.White)
            }
        }
    }
}

sealed class ScanResult {
    data class Success(val studentName: String) : ScanResult()
    object Error : ScanResult()
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/screens/cook/QRScannerScreen.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/components/CommonComponents.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/components/CommonComponents.kt
# ==============================================================================

package org.pgk.food.presentation.components

import androidx.compose.foundation.layout.*
import androidx.compose.material3.*
import androidx.compose.runtime.Composable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.painter.Painter
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.unit.dp
import org.pgk.food.data.remote.dto.UserCredentialsResponse

// Твои правильные импорты
import org.jetbrains.compose.resources.painterResource
import org.pgk.food.resources.Res
import org.pgk.food.resources.ic_check_circle

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun QuickActionCard(
    title: String,
    iconPainter: Painter,
    onClick: () -> Unit,
    modifier: Modifier = Modifier
) {
    Card(
        onClick = onClick,
        modifier = modifier,
        colors = CardDefaults.cardColors(
            containerColor = MaterialTheme.colorScheme.secondaryContainer
        )
    ) {
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(20.dp),
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            Icon(
                painter = iconPainter,
                contentDescription = null,
                modifier = Modifier.size(40.dp),
                tint = MaterialTheme.colorScheme.onSecondaryContainer
            )
            Spacer(Modifier.height(8.dp))
            Text(
                title,
                style = MaterialTheme.typography.titleSmall,
                fontWeight = FontWeight.SemiBold
            )
        }
    }
}

@Composable
fun CreatedUserDialog(
    user: UserCredentialsResponse,
    onDismiss: () -> Unit
) {
    AlertDialog(
        onDismissRequest = onDismiss,
        icon = {
            Icon(
                painter = painterResource(Res.drawable.ic_check_circle),
                contentDescription = null,
                tint = MaterialTheme.colorScheme.primary
            )
        },
        title = { Text("Пользователь создан") },
        text = {
            Column {
                Text("Запишите эти данные:", fontWeight = FontWeight.Bold)
                Spacer(Modifier.height(8.dp))
                Text("Логин: ${user.login}")
                Text("Пароль: ${user.passwordClearText}")
                Spacer(Modifier.height(8.dp))
                Text(
                    "Пароль показывается только один раз!",
                    color = MaterialTheme.colorScheme.error,
                    style = MaterialTheme.typography.bodySmall
                )
            }
        },
        confirmButton = {
            TextButton(onClick = onDismiss) {
                Text("Понятно")
            }
        }
    )
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/components/CommonComponents.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/components/QRCodeView.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/components/QRCodeView.kt
# ==============================================================================

package org.pgk.food.presentation.components

class QRCodeView {
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/components/QRCodeView.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/components/QuickActionCard.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/components/QuickActionCard.kt
# ==============================================================================

package org.pgk.food.presentation.components

import androidx.compose.foundation.layout.*
import androidx.compose.material3.*
import androidx.compose.runtime.Composable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.vector.ImageVector
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.unit.dp

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun QuickActionCard(
    title: String,
    icon: ImageVector,
    onClick: () -> Unit,
    modifier: Modifier = Modifier
) {
    Card(
        onClick = onClick,
        modifier = modifier,
        colors = CardDefaults.cardColors(
            containerColor = MaterialTheme.colorScheme.secondaryContainer
        )
    ) {
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(20.dp),
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            Icon(
                imageVector = icon,
                contentDescription = null,
                modifier = Modifier.size(40.dp),
                tint = MaterialTheme.colorScheme.onSecondaryContainer
            )
            Spacer(Modifier.height(8.dp))
            Text(
                text = title,
                style = MaterialTheme.typography.titleSmall,
                fontWeight = FontWeight.SemiBold
            )
        }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/components/QuickActionCard.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/components/TicketCard.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/components/TicketCard.kt
# ==============================================================================

package org.pgk.food.presentation.components

class TicketCard {
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/components/TicketCard.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/navigation/AppNavigation.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/presentation/navigation/AppNavigation.kt
# ==============================================================================

package org.pgk.food.presentation.navigation

import cafe.adriel.voyager.core.screen.Screen
import cafe.adriel.voyager.navigator.Navigator
import org.pgk.food.domain.model.Role
import org.pgk.food.presentation.screens.auth.LoginScreen
import org.pgk.food.presentation.screens.student.StudentHomeScreen
import org.pgk.food.presentation.screens.cook.CookHomeScreen // Убедись, что создал этот экран
import org.pgk.food.presentation.screens.registrar.RegistrarHomeScreen
import org.pgk.food.presentation.screens.curator.CuratorHomeScreen
import org.pgk.food.presentation.screens.admin.AdminDashboardScreen

fun Navigator.navigateToHome(roles: List<Role>) {
    val homeScreen: Screen = when {
        roles.contains(Role.ADMIN) -> AdminDashboardScreen()
        roles.contains(Role.CHEF) -> CookHomeScreen() // Или ScannerScreen
        roles.contains(Role.REGISTRAR) -> RegistrarHomeScreen()
        roles.contains(Role.CURATOR) -> CuratorHomeScreen()
        roles.contains(Role.STUDENT) -> StudentHomeScreen()
        else -> LoginScreen()
    }
    replaceAll(homeScreen)
}

fun Navigator.logout() {
    replaceAll(LoginScreen())
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/presentation/navigation/AppNavigation.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/ui/theme/Color.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/ui/theme/Color.kt
# ==============================================================================

package org.pgk.food.ui.theme // <--- ВОТ ТВОЙ ПРАВИЛЬНЫЙ ПАКЕТ

import androidx.compose.ui.graphics.Color

// Твои цвета
val primaryLight = Color(0xFF31559E)
val onPrimaryLight = Color(0xFFFFFFFF)
val primaryContainerLight = Color(0xFF4C6EB8)
val onPrimaryContainerLight = Color(0xFFF3F4FF)
val secondaryLight = Color(0xFF180258)
val onSecondaryLight = Color(0xFFFFFFFF)
val secondaryContainerLight = Color(0xFF2D1F6C)
val onSecondaryContainerLight = Color(0xFF968ADC)
val tertiaryLight = Color(0xFF4C6075)
val onTertiaryLight = Color(0xFFFFFFFF)
val tertiaryContainerLight = Color(0xFFC0D6EE)
val onTertiaryContainerLight = Color(0xFF485D71)
val errorLight = Color(0xFFBA1A1A)
val onErrorLight = Color(0xFFFFFFFF)
val errorContainerLight = Color(0xFFFFDAD6)
val onErrorContainerLight = Color(0xFF93000A)
val backgroundLight = Color(0xFFFAF8FF)
val onBackgroundLight = Color(0xFF1A1B20)
val surfaceLight = Color(0xFFFAF8FF)
val onSurfaceLight = Color(0xFF1A1B20)
val surfaceVariantLight = Color(0xFFE0E2EF)
val onSurfaceVariantLight = Color(0xFF434651)
val outlineLight = Color(0xFF747782)
val outlineVariantLight = Color(0xFFC4C6D2)
val scrimLight = Color(0xFF000000)
val inverseSurfaceLight = Color(0xFF2F3035)
val inverseOnSurfaceLight = Color(0xFFF1F0F7)
val inversePrimaryLight = Color(0xFFB0C6FF)
val surfaceDimLight = Color(0xFFDAD9E0)
val surfaceBrightLight = Color(0xFFFAF8FF)
val surfaceContainerLowestLight = Color(0xFFFFFFFF)
val surfaceContainerLowLight = Color(0xFFF4F3FA)
val surfaceContainerLight = Color(0xFFEEEDF4)
val surfaceContainerHighLight = Color(0xFFE8E7EE)
val surfaceContainerHighestLight = Color(0xFFE2E2E9)

val primaryDark = Color(0xFFB0C6FF)
val onPrimaryDark = Color(0xFF002D6E)
val primaryContainerDark = Color(0xFF4C6EB8)
val onPrimaryContainerDark = Color(0xFFF3F4FF)
val secondaryDark = Color(0xFFC9BFFF)
val onSecondaryDark = Color(0xFF30236F)
val secondaryContainerDark = Color(0xFF2D1F6C)
val onSecondaryContainerDark = Color(0xFF968ADC)
val tertiaryDark = Color(0xFFE6F1FF)
val onTertiaryDark = Color(0xFF1D3245)
val tertiaryContainerDark = Color(0xFFC0D6EE)
val onTertiaryContainerDark = Color(0xFF485D71)
val errorDark = Color(0xFFFFB4AB)
val onErrorDark = Color(0xFF690005)
val errorContainerDark = Color(0xFF93000A)
val onErrorContainerDark = Color(0xFFFFDAD6)
val backgroundDark = Color(0xFF121318)
val onBackgroundDark = Color(0xFFE2E2E9)
val surfaceDark = Color(0xFF121318)
val onSurfaceDark = Color(0xFFE2E2E9)
val surfaceVariantDark = Color(0xFF434651)
val onSurfaceVariantDark = Color(0xFFC4C6D2)
val outlineDark = Color(0xFF8E909C)
val outlineVariantDark = Color(0xFF434651)
val scrimDark = Color(0xFF000000)
val inverseSurfaceDark = Color(0xFFE2E2E9)
val inverseOnSurfaceDark = Color(0xFF2F3035)
val inversePrimaryDark = Color(0xFF395CA5)
val surfaceDimDark = Color(0xFF121318)
val surfaceBrightDark = Color(0xFF38393E)
val surfaceContainerLowestDark = Color(0xFF0D0E13)
val surfaceContainerLowDark = Color(0xFF1A1B20)
val surfaceContainerDark = Color(0xFF1E1F24)
val surfaceContainerHighDark = Color(0xFF282A2F)
val surfaceContainerHighestDark = Color(0xFF33353A)

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/ui/theme/Color.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/ui/theme/Theme.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/ui/theme/Theme.kt
# ==============================================================================

package org.pgk.food.ui.theme // <--- ВАЖНО

import androidx.compose.foundation.isSystemInDarkTheme
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.runtime.Composable

private val LightColorScheme = lightColorScheme(
    primary = primaryLight,
    onPrimary = onPrimaryLight,
    primaryContainer = primaryContainerLight,
    onPrimaryContainer = onPrimaryContainerLight,
    secondary = secondaryLight,
    onSecondary = onSecondaryLight,
    secondaryContainer = secondaryContainerLight,
    onSecondaryContainer = onSecondaryContainerLight,
    tertiary = tertiaryLight,
    onTertiary = onTertiaryLight,
    tertiaryContainer = tertiaryContainerLight,
    onTertiaryContainer = onTertiaryContainerLight,
    error = errorLight,
    onError = onErrorLight,
    errorContainer = errorContainerLight,
    onErrorContainer = onErrorContainerLight,
    background = backgroundLight,
    onBackground = onBackgroundLight,
    surface = surfaceLight,
    onSurface = onSurfaceLight,
    surfaceVariant = surfaceVariantLight,
    onSurfaceVariant = onSurfaceVariantLight,
    outline = outlineLight,
    outlineVariant = outlineVariantLight,
    scrim = scrimLight,
    inverseSurface = inverseSurfaceLight,
    inverseOnSurface = inverseOnSurfaceLight,
    inversePrimary = inversePrimaryLight,
    surfaceDim = surfaceDimLight,
    surfaceBright = surfaceBrightLight,
    surfaceContainerLowest = surfaceContainerLowestLight,
    surfaceContainerLow = surfaceContainerLowLight,
    surfaceContainer = surfaceContainerLight,
    surfaceContainerHigh = surfaceContainerHighLight,
    surfaceContainerHighest = surfaceContainerHighestLight,
)

private val DarkColorScheme = darkColorScheme(
    primary = primaryDark,
    onPrimary = onPrimaryDark,
    primaryContainer = primaryContainerDark,
    onPrimaryContainer = onPrimaryContainerDark,
    secondary = secondaryDark,
    onSecondary = onSecondaryDark,
    secondaryContainer = secondaryContainerDark,
    onSecondaryContainer = onSecondaryContainerDark,
    tertiary = tertiaryDark,
    onTertiary = onTertiaryDark,
    tertiaryContainer = tertiaryContainerDark,
    onTertiaryContainer = onTertiaryContainerDark,
    error = errorDark,
    onError = onErrorDark,
    errorContainer = errorContainerDark,
    onErrorContainer = onErrorContainerDark,
    background = backgroundDark,
    onBackground = onBackgroundDark,
    surface = surfaceDark,
    onSurface = onSurfaceDark,
    surfaceVariant = surfaceVariantDark,
    onSurfaceVariant = onSurfaceVariantDark,
    outline = outlineDark,
    outlineVariant = outlineVariantDark,
    scrim = scrimDark,
    inverseSurface = inverseSurfaceDark,
    inverseOnSurface = inverseOnSurfaceDark,
    inversePrimary = inversePrimaryDark,
    surfaceDim = surfaceDimDark,
    surfaceBright = surfaceBrightDark,
    surfaceContainerLowest = surfaceContainerLowestDark,
    surfaceContainerLow = surfaceContainerLowDark,
    surfaceContainer = surfaceContainerDark,
    surfaceContainerHigh = surfaceContainerHighDark,
    surfaceContainerHighest = surfaceContainerHighestDark,
)

@Composable
fun AppTheme(
    darkTheme: Boolean = isSystemInDarkTheme(),
    content: @Composable () -> Unit
) {
    val colorScheme = if (darkTheme) DarkColorScheme else LightColorScheme

    MaterialTheme(
        colorScheme = colorScheme,
        content = content
    )
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/ui/theme/Theme.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/domain/usecase/UseCases.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/domain/usecase/UseCases.kt
# ==============================================================================

package org.pgk.food.domain.usecase

import org.pgk.food.data.repository.AuthRepository
import org.pgk.food.data.repository.TransactionRepository
import org.pgk.food.domain.model.MealType
import org.pgk.food.domain.model.User
import org.pgk.food.utils.QRCodeBitmap
import org.pgk.food.utils.QRGenerator
import org.pgk.food.utils.TOTPValidator

class GenerateQRUseCase(
    private val qrGenerator: QRGenerator,
    private val totpValidator: TOTPValidator
) {
    operator fun invoke(userId: String, mealType: MealType, privateKey: String, serverTimeDelta: Long = 0): QRCodeBitmap {
        return qrGenerator.generateQRCode(userId, mealType, privateKey, totpValidator, serverTimeDelta)
    }
}

class ValidateQRUseCase(
    private val qrGenerator: QRGenerator,
    private val totpValidator: TOTPValidator,
    private val transactionRepository: TransactionRepository
) {
    suspend operator fun invoke(qrText: String, publicKey: String, serverTimeDelta: Long = 0): Result<Boolean> = runCatching {
        // Твоя логика валидации тут
        true
    }
}

class LoginUseCase(private val authRepository: AuthRepository) {
    suspend operator fun invoke(l: String, p: String): Result<User> = authRepository.login(l, p)
}

// Заглушки для Koin, чтобы не падал
class SyncTransactionsUseCase(repo: TransactionRepository)
class CreateUserUseCase(repo: Any)
class GetRosterUseCase(repo: Any)
class UpdateRosterUseCase(repo: Any)

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/domain/usecase/UseCases.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/domain/model/Models.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/domain/model/Models.kt
# ==============================================================================

package org.pgk.food.domain.model

enum class Role {
    STUDENT, CHEF, REGISTRAR, CURATOR, ADMIN;

    companion object {
        fun fromString(s: String) = entries.find { it.name == s } ?: STUDENT
    }
}

enum class MealType {
    BREAKFAST, LUNCH, DINNER, SNACK, SPECIAL
}

data class User(
    val id: String,
    val login: String,
    val name: String,
    val surname: String,
    val fatherName: String,
    val roles: List<Role>,
    val groupId: Int?,
    val privateKey: String,
    val publicKey: String
) {
    val fullName: String get() = "$surname $name $fatherName"

    fun hasRole(role: Role) = roles.contains(role)
}

data class Ticket(
    val id: String,
    val studentId: String,
    val mealType: MealType,
    val date: String,
    val isUsed: Boolean = false
)

data class QRPayload(
    val userId: String,
    val timestamp: Long,
    val mealType: MealType,
    val nonce: String,
    val signature: String
)

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/domain/model/Models.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/utils/QRGenerator.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/utils/QRGenerator.kt
# ==============================================================================

package org.pgk.food.utils

import com.google.zxing.BarcodeFormat
import com.google.zxing.qrcode.QRCodeWriter
import com.google.zxing.common.BitMatrix
import kotlinx.serialization.Serializable
import kotlinx.serialization.encodeToString
import kotlinx.serialization.json.Json
import org.pgk.food.domain.model.MealType

@Serializable
data class QRData(
    val userId: String,
    val timestamp: Long,
    val mealType: String,
    val nonce: String,
    val signature: String
)

data class QRCodeBitmap(
    val bitMatrix: BitMatrix,
    val rawData: String
)

class QRGenerator {
    private val writer = QRCodeWriter()
    private val json = Json { ignoreUnknownKeys = true }

    fun generateQRCode(
        userId: String,
        mealType: MealType,
        privateKey: String,
        totpValidator: TOTPValidator,
        serverTimeDelta: Long = 0
    ): QRCodeBitmap {
        val timestamp = totpValidator.getCurrentTimeSlot(serverTimeDelta) * TOTPValidator.TIME_WINDOW_SECONDS
        val nonce = totpValidator.generateNonce()
        val signature = totpValidator.signQRPayload(userId, timestamp, mealType, nonce, privateKey)

        val data = QRData(
            userId = userId,
            timestamp = timestamp,
            mealType = mealType.name,
            nonce = nonce,
            signature = signature
        )

        val qrText = json.encodeToString(data)
        // Генерируем QR 512x512
        val bitMatrix = writer.encode(qrText, BarcodeFormat.QR_CODE, 512, 512)

        return QRCodeBitmap(bitMatrix, qrText)
    }

    fun parseQRCode(qrText: String): Result<QRData> = runCatching {
        json.decodeFromString<QRData>(qrText)
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/utils/QRGenerator.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/utils/TOTPValidator.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/utils/TOTPValidator.kt
# ==============================================================================

package org.pgk.food.utils

import kotlinx.datetime.Clock
import org.pgk.food.domain.model.MealType
import kotlin.random.Random

class TOTPValidator {
    companion object {
        const val TIME_WINDOW_SECONDS = 30L
        const val ALLOWED_TIME_DRIFT = 2
    }

    fun getCurrentTimeSlot(serverTimeDelta: Long = 0): Long {
        val now = Clock.System.now().epochSeconds + serverTimeDelta
        return now / TIME_WINDOW_SECONDS
    }

    fun isTimestampValid(qrTimestamp: Long, serverTimeDelta: Long = 0): Boolean {
        val currentSlot = getCurrentTimeSlot(serverTimeDelta)
        val qrSlot = qrTimestamp / TIME_WINDOW_SECONDS
        val diff = kotlin.math.abs(currentSlot - qrSlot)
        return diff <= ALLOWED_TIME_DRIFT
    }

    fun signQRPayload(
        userId: String,
        timestamp: Long,
        mealType: MealType,
        nonce: String,
        privateKey: String
    ): String {
        val data = "$userId:$timestamp:${mealType.name}:$nonce"
        val combined = data + privateKey
        return combined.hashCode().toString(16).padStart(16, '0')
    }

    fun verifySignature(
        userId: String,
        timestamp: Long,
        mealType: MealType,
        nonce: String,
        signature: String,
        publicKey: String
    ): Boolean {
        val data = "$userId:$timestamp:${mealType.name}:$nonce"
        val combined = data + publicKey
        val expectedSignature = combined.hashCode().toString(16).padStart(16, '0')
        return signature == expectedSignature
    }

    fun generateNonce(): String {
        val bytes = ByteArray(16)
        Random.Default.nextBytes(bytes)
        return bytes.joinToString("") { "%02x".format(it) }
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/utils/TOTPValidator.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/utils/TokenValidator.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/utils/TokenValidator.kt
# ==============================================================================

package org.pgk.food.utils

class TokenValidator     {
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/utils/TokenValidator.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/di/AppModule.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/di/AppModule.kt
# ==============================================================================

package org.pgk.food.di

import org.koin.dsl.module
import org.pgk.food.data.remote.ApiClient
import org.pgk.food.data.repository.*
import org.pgk.food.domain.usecase.*
import org.pgk.food.presentation.screens.auth.LoginViewModel
import org.pgk.food.presentation.screens.student.StudentHomeViewModel
import org.pgk.food.presentation.screens.admin.AdminViewModel
import org.pgk.food.presentation.screens.registrar.RegistrarViewModel
import org.pgk.food.utils.QRGenerator
import org.pgk.food.utils.TOTPValidator

val dataModule = module {
    // Database stubs (null for now)
    single<Any?> { null }

    single { ApiClient { get<TokenStorage>().getToken() } }
    single { createTokenStorage() }

    single { AuthRepository(get(), get(), get()) }
    single { TicketRepository(get()) }
    single { TransactionRepository(get(), get()) }
}

val domainModule = module {
    factory { LoginUseCase(get()) }
    factory { GenerateQRUseCase(get(), get()) }
    factory { ValidateQRUseCase(get(), get(), get()) }

    single { QRGenerator() }
    single { TOTPValidator() }
}

val presentationModule = module {
    factory { LoginViewModel(get()) }
    factory { StudentHomeViewModel(get(), get(), get()) }
    factory { AdminViewModel() }
    factory { RegistrarViewModel() }
}

val appModule = listOf(dataModule, domainModule, presentationModule)

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/di/AppModule.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/di/CommonDi.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/di/CommonDi.kt
# ==============================================================================

package org.pgk.food.di
import org.pgk.food.data.repository.TokenStorage
expect fun createTokenStorage(): TokenStorage

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/di/CommonDi.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/di/TokenStorage.android.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/di/TokenStorage.android.kt
# ==============================================================================

package org.pgk.food.di

import android.content.Context
import android.content.SharedPreferences
import org.koin.core.component.KoinComponent
import org.koin.core.component.inject
import org.pgk.food.data.repository.TokenStorage

// Actual factory
actual fun createTokenStorage(): TokenStorage = AndroidTokenStorage()

class AndroidTokenStorage : TokenStorage, KoinComponent {
    private val context: Context by inject()
    private val prefs: SharedPreferences by lazy {
        context.getSharedPreferences("pgk_food_prefs", Context.MODE_PRIVATE)
    }
    override fun saveToken(token: String) { prefs.edit().putString("auth_token", token).apply() }
    override fun getToken(): String? = prefs.getString("auth_token", null)
    override fun clearToken() { prefs.edit().clear().apply() }
    override fun getCurrentUserId(): String? = prefs.getString("user_id", null)
    override fun saveUserId(userId: String) { prefs.edit().putString("user_id", userId).apply() }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/di/TokenStorage.android.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/di/TokenStorage.ios.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/di/TokenStorage.ios.kt
# ==============================================================================

package org.pgk.food.di

import org.pgk.food.data.repository.TokenStorage
import platform.Foundation.NSUserDefaults

actual fun createTokenStorage(): TokenStorage = IOSTokenStorage()

class IOSTokenStorage : TokenStorage {
    private val defaults = NSUserDefaults.standardUserDefaults
    override fun saveToken(token: String) = defaults.setObject(token, "auth_token")
    override fun getToken(): String? = defaults.stringForKey("auth_token")
    override fun clearToken() { defaults.removeObjectForKey("auth_token"); defaults.removeObjectForKey("user_id") }
    override fun getCurrentUserId(): String? = defaults.stringForKey("user_id")
    override fun saveUserId(userId: String) = defaults.setObject(userId, "user_id")
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/di/TokenStorage.ios.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/data/remote/api/ApiClient.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/data/remote/api/ApiClient.kt
# ==============================================================================

package org.pgk.food.data.remote

import io.ktor.client.*
import io.ktor.client.call.*
import io.ktor.client.plugins.*
import io.ktor.client.plugins.contentnegotiation.*
import io.ktor.client.plugins.logging.*
import io.ktor.client.request.*
import io.ktor.http.*
import io.ktor.serialization.kotlinx.json.*
import kotlinx.serialization.json.Json
import org.pgk.food.data.remote.dto.*

class ApiClient(
    private val baseUrl: String = "https://food.pgk.apis.alspio.com/api/v1",
    private val tokenProvider: () -> String?
) {
    private val client = HttpClient {
        install(ContentNegotiation) {
            json(Json {
                ignoreUnknownKeys = true
                isLenient = true
                prettyPrint = true
            })
        }

        install(Logging) {
            logger = Logger.DEFAULT
            level = LogLevel.BODY
        }

        install(DefaultRequest) {
            url(baseUrl)
            contentType(ContentType.Application.Json)
        }

        install(HttpTimeout) {
            requestTimeoutMillis = 30000
            connectTimeoutMillis = 15000
        }
    }

    // ========================================================================
    // AUTH API
    // ========================================================================

    suspend fun login(login: String, password: String): Result<AuthResponse> = runCatching {
        client.post("/auth/login") {
            setBody(LoginRequest(login, password))
        }.body()
    }

    // ========================================================================
    // TIME SYNC API (для TOTP)
    // ========================================================================

    suspend fun getServerTime(): Result<TimeResponse> = runCatching {
        client.get("/time/current").body()
    }

    // ========================================================================
    // QR VALIDATION API
    // ========================================================================

    suspend fun validateQROnline(request: ValidateQRRequest): Result<ValidateQRResponse> = runCatching {
        client.post("/qr/validate") {
            bearerAuth(tokenProvider() ?: throw IllegalStateException("No token"))
            setBody(request)
        }.body()
    }

    suspend fun validateQROffline(request: ValidateQRRequest): Result<ValidateQRResponse> = runCatching {
        client.post("/qr/validate-offline") {
            setBody(request)
        }.body()
    }

    // ========================================================================
    // TRANSACTIONS API (синхронизация сканов повара)
    // ========================================================================

    suspend fun syncTransactionsBatch(items: List<TransactionSyncItem>): Result<SyncResponse> = runCatching {
        client.post("/transactions/batch") {
            bearerAuth(tokenProvider() ?: throw IllegalStateException("No token"))
            setBody(items)
        }.body()
    }

    // ========================================================================
    // REGISTRAR API (регистрация студентов)
    // ========================================================================

    suspend fun createUser(request: CreateUserRequest): Result<UserCredentialsResponse> = runCatching {
        client.post("/registrator/users/create") {
            bearerAuth(tokenProvider() ?: throw IllegalStateException("No token"))
            setBody(request)
        }.body()
    }

    suspend fun resetPassword(userId: String): Result<UserCredentialsResponse> = runCatching {
        client.post("/registrator/users/$userId/reset-password") {
            bearerAuth(tokenProvider() ?: throw IllegalStateException("No token"))
        }.body()
    }

    // ========================================================================
    // GROUPS API
    // ========================================================================

    suspend fun getAllGroups(): Result<List<GroupDto>> = runCatching {
        client.get("/groups") {
            bearerAuth(tokenProvider() ?: throw IllegalStateException("No token"))
        }.body()
    }

    suspend fun setCurator(groupId: Int, curatorId: String): Result<GroupDto> = runCatching {
        client.put("/groups/$groupId/curator/$curatorId") {
            bearerAuth(tokenProvider() ?: throw IllegalStateException("No token"))
        }.body()
    }

    suspend fun addStudentToGroup(groupId: Int, studentId: String): Result<Unit> = runCatching {
        client.post("/groups/$groupId/students/$studentId") {
            bearerAuth(tokenProvider() ?: throw IllegalStateException("No token"))
        }
    }

    // ========================================================================
    // ROSTER API (табель питания)
    // ========================================================================

    suspend fun getRoster(date: String): Result<List<StudentRosterRow>> = runCatching {
        client.get("/roster") {
            bearerAuth(tokenProvider() ?: throw IllegalStateException("No token"))
            parameter("date", date)
        }.body()
    }

    suspend fun updateRoster(request: UpdateRosterRequest): Result<Unit> = runCatching {
        client.post("/roster") {
            bearerAuth(tokenProvider() ?: throw IllegalStateException("No token"))
            setBody(request)
        }
    }

    // ========================================================================
    // REPORTS API
    // ========================================================================

    suspend fun getDailyReport(date: String): Result<DailyReportResponse> = runCatching {
        client.get("/reports/daily") {
            bearerAuth(tokenProvider() ?: throw IllegalStateException("No token"))
            parameter("date", date)
        }.body()
    }

    suspend fun getWeeklyReport(startDate: String): Result<List<DailyReportResponse>> = runCatching {
        client.get("/reports/weekly") {
            bearerAuth(tokenProvider() ?: throw IllegalStateException("No token"))
            parameter("startDate", startDate)
        }.body()
    }
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/data/remote/api/ApiClient.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/data/remote/dto/RemoteDto.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/data/remote/dto/RemoteDto.kt
# ==============================================================================

package org.pgk.food.data.remote.dto

import kotlinx.serialization.Serializable

@Serializable
data class LoginRequest(
    val login: String,
    val password: String
)

@Serializable
data class AuthResponse(
    val token: String,
    val roles: List<String>,
    val privateKey: String,
    val publicKey: String
)

@Serializable
data class UserDto(
    val id: String,
    val login: String,
    val name: String,
    val surname: String,
    val fatherName: String,
    val roles: List<String>,
    val groupId: Int? = null
)

@Serializable
data class CreateUserRequest(
    val roles: List<String>,
    val name: String,
    val surname: String,
    val fatherName: String,
    val groupId: Int? = null
)

@Serializable
data class UserCredentialsResponse(
    val userId: String,
    val login: String,
    val passwordClearText: String,
    val fullName: String
)

@Serializable
data class GroupDto(
    val id: Int,
    val name: String,
    val curatorId: String?,
    val curatorName: String?,
    val curatorSurname: String?,
    val curatorFatherName: String?,
    val studentCount: Int
)

@Serializable
data class ValidateQRRequest(
    val userId: String,
    val timestamp: Long,
    val mealType: String,
    val nonce: String,
    val signature: String
)

@Serializable
data class ValidateQRResponse(
    val isValid: Boolean,
    val studentName: String?,
    val groupName: String? = null,
    val errorMessage: String? = null,
    val errorCode: String? = null
)

@Serializable
data class TransactionSyncItem(
    val studentId: String,
    val timestamp: String, // ISO-8601
    val mealType: String,
    val transactionHash: String? = null
)

@Serializable
data class SyncResponse(
    val successCount: Int,
    val errors: List<String>
)

@Serializable
data class DayPermissionDto(
    val date: String,
    val isBreakfast: Boolean,
    val isLunch: Boolean,
    val isDinner: Boolean,
    val isSnack: Boolean = false,
    val isSpecial: Boolean = false,
    val reason: String? = null
)

@Serializable
data class UpdateRosterRequest(
    val studentId: String,
    val permissions: List<DayPermissionDto>
)

@Serializable
data class StudentRosterRow(
    val studentId: String,
    val fullName: String,
    val days: List<DayPermissionDto>
)

@Serializable
data class TimeResponse(
    val timestamp: Long,
    val iso8601: String
)

@Serializable
data class DailyReportResponse(
    val date: String,
    val total: Int,
    val breakfast: Int,
    val lunch: Int,
    val dinner: Int
)

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/data/remote/dto/RemoteDto.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/data/local/dao/Daos.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/data/local/dao/Daos.kt
# ==============================================================================

package org.pgk.food.data.local.dao

import androidx.room.*
import kotlinx.coroutines.flow.Flow
import org.pgk.food.data.local.entities.*

@Dao
interface UserDao {
    @Query("SELECT * FROM users WHERE id = :id")
    suspend fun getById(id: String): UserEntity?

    @Insert(onConflict = OnConflictStrategy.REPLACE)
    suspend fun insert(user: UserEntity)

    @Query("DELETE FROM users")
    suspend fun clearAll()

    @Query("SELECT * FROM users WHERE id = :id")
    fun observeUser(id: String): Flow<UserEntity?>
}

@Dao
interface TicketDao {
    @Query("SELECT * FROM tickets WHERE studentId = :studentId AND date = :date")
    suspend fun getTicketsForDate(studentId: String, date: String): List<TicketEntity>

    @Query("SELECT * FROM tickets WHERE studentId = :studentId ORDER BY date DESC LIMIT 30")
    fun observeRecentTickets(studentId: String): Flow<List<TicketEntity>>

    @Insert(onConflict = OnConflictStrategy.REPLACE)
    suspend fun insertAll(tickets: List<TicketEntity>)

    @Query("UPDATE tickets SET isUsed = 1, usedAt = :timestamp WHERE id = :ticketId")
    suspend fun markAsUsed(ticketId: String, timestamp: Long)

    @Query("DELETE FROM tickets WHERE date < :cutoffDate")
    suspend fun deleteOldTickets(cutoffDate: String)
}

@Dao
interface GroupDao {
    @Query("SELECT * FROM groups")
    suspend fun getAll(): List<GroupEntity>

    @Query("SELECT * FROM groups WHERE id = :id")
    suspend fun getById(id: Int): GroupEntity?

    @Insert(onConflict = OnConflictStrategy.REPLACE)
    suspend fun insertAll(groups: List<GroupEntity>)

    @Query("DELETE FROM groups")
    suspend fun clearAll()
}

@Dao
interface TransactionDao {
    @Insert(onConflict = OnConflictStrategy.REPLACE)
    suspend fun insert(transaction: TransactionEntity)

    @Query("SELECT * FROM transactions WHERE syncedToServer = 0")
    suspend fun getUnsyncedTransactions(): List<TransactionEntity>

    @Query("UPDATE transactions SET syncedToServer = 1 WHERE id IN (:ids)")
    suspend fun markAsSynced(ids: List<String>)

    @Query("SELECT * FROM transactions WHERE timestamp > :sinceTimestamp ORDER BY timestamp DESC")
    fun observeRecentTransactions(sinceTimestamp: Long): Flow<List<TransactionEntity>>

    @Query("DELETE FROM transactions WHERE timestamp < :cutoffTimestamp")
    suspend fun deleteOldTransactions(cutoffTimestamp: Long)
}

@Dao
interface RosterDao {
    @Query("SELECT * FROM roster_permissions WHERE studentId = :studentId AND date = :date")
    suspend fun getPermissionsForDate(studentId: String, date: String): RosterPermissionEntity?

    @Query("SELECT * FROM roster_permissions WHERE studentId = :studentId AND date BETWEEN :startDate AND :endDate")
    suspend fun getPermissionsForWeek(studentId: String, startDate: String, endDate: String): List<RosterPermissionEntity>

    @Insert(onConflict = OnConflictStrategy.REPLACE)
    suspend fun insertAll(permissions: List<RosterPermissionEntity>)

    @Query("DELETE FROM roster_permissions WHERE date < :cutoffDate")
    suspend fun deleteOldPermissions(cutoffDate: String)
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/data/local/dao/Daos.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/data/local/database/AppDatabase.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/data/local/database/AppDatabase.kt
# ==============================================================================

package org.pgk.food.data.local.database

import androidx.room.Database
import androidx.room.RoomDatabase
import androidx.sqlite.driver.bundled.BundledSQLiteDriver
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.IO
import org.pgk.food.data.local.dao.*
import org.pgk.food.data.local.entities.*

@Database(
    entities = [
        UserEntity::class,
        TicketEntity::class,
        GroupEntity::class,
        TransactionEntity::class,
        RosterPermissionEntity::class
    ],
    version = 1,
    exportSchema = true
)
abstract class AppDatabase : RoomDatabase() {
    abstract fun userDao(): UserDao
    abstract fun ticketDao(): TicketDao
    abstract fun groupDao(): GroupDao
    abstract fun transactionDao(): TransactionDao
    abstract fun rosterDao(): RosterDao
}

// Expect function for DB Builder
expect fun getDatabaseBuilder(): RoomDatabase.Builder<AppDatabase>

fun createDatabase(builder: RoomDatabase.Builder<AppDatabase>): AppDatabase {
    return builder
        .setDriver(BundledSQLiteDriver())
        .setQueryCoroutineContext(Dispatchers.IO)
        .build()
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/data/local/database/AppDatabase.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/data/local/entities/Entities.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/data/local/entities/Entities.kt
# ==============================================================================

package org.pgk.food.data.local.entities

import androidx.room.Entity
import androidx.room.PrimaryKey
import androidx.room.TypeConverter
import androidx.room.TypeConverters
import kotlinx.serialization.Serializable
import kotlinx.serialization.encodeToString
import kotlinx.serialization.json.Json

@Entity(tableName = "users")
@TypeConverters(RoleListConverter::class)
data class UserEntity(
    @PrimaryKey val id: String,
    val login: String,
    val name: String,
    val surname: String,
    val fatherName: String,
    val roles: List<String>, // ["STUDENT", "CURATOR"]
    val groupId: Int?,
    val privateKey: String,
    val publicKey: String
)

@Entity(tableName = "tickets")
data class TicketEntity(
    @PrimaryKey val id: String,
    val studentId: String,
    val mealType: String, // BREAKFAST, LUNCH, DINNER, SNACK, SPECIAL
    val date: String, // ISO-8601: "2025-12-14"
    val isUsed: Boolean = false,
    val usedAt: Long? = null // timestamp
)

@Entity(tableName = "groups")
data class GroupEntity(
    @PrimaryKey val id: Int,
    val name: String,
    val curatorId: String?,
    val curatorName: String?
)

@Entity(tableName = "transactions")
data class TransactionEntity(
    @PrimaryKey val id: String,
    val studentId: String,
    val timestamp: Long,
    val mealType: String,
    val qrHash: String,
    val syncedToServer: Boolean = false
)

@Entity(tableName = "roster_permissions")
data class RosterPermissionEntity(
    @PrimaryKey(autoGenerate = true) val id: Long = 0,
    val studentId: String,
    val date: String,
    val isBreakfast: Boolean = false,
    val isLunch: Boolean = false,
    val isDinner: Boolean = false,
    val isSnack: Boolean = false,
    val isSpecial: Boolean = false,
    val reason: String? = null
)

// Конвертеры для Room
class RoleListConverter {
    @TypeConverter
    fun fromString(value: String): List<String> = Json.decodeFromString(value)

    @TypeConverter
    fun toString(list: List<String>): String = Json.encodeToString(list)
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/data/local/entities/Entities.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/data/repository/Repositories.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/data/repository/Repositories.kt
# ==============================================================================

package org.pgk.food.data.repository

import kotlinx.coroutines.flow.Flow
import kotlinx.coroutines.flow.map
import kotlinx.coroutines.flow.flowOf
import org.pgk.food.data.local.dao.UserDao
import org.pgk.food.data.local.dao.TicketDao
import org.pgk.food.data.local.dao.TransactionDao
import org.pgk.food.data.local.entities.*
import org.pgk.food.data.remote.ApiClient
import org.pgk.food.data.remote.dto.*
import org.pgk.food.domain.model.*

class AuthRepository(
    private val api: ApiClient,
    private val userDao: UserDao,
    private val tokenStorage: TokenStorage
) {
    suspend fun login(login: String, password: String): Result<User> {
        return api.login(login, password).mapCatching { response ->
            // Сохраняем токен
            tokenStorage.saveToken(response.token)

            // Сохраняем пользователя локально
            val user = User(
                id = "temp", // Нужно получить userId с сервера (добавь в AuthResponse)
                login = login,
                name = "",
                surname = "",
                fatherName = "",
                roles = response.roles.map { Role.valueOf(it) },
                groupId = null,
                privateKey = response.privateKey,
                publicKey = response.publicKey
            )

            userDao.insert(user.toEntity())
            user
        }
    }

    suspend fun logout() {
        tokenStorage.clearToken()
        userDao.clearAll()
    }

    fun getCurrentUser(): Flow<User?> {
        val userId = tokenStorage.getCurrentUserId() ?: return flowOf(null)
        return userDao.observeUser(userId).map { it?.toDomain() }
    }
}

class TicketRepository(
    private val ticketDao: TicketDao
) {
    fun getRecentTickets(studentId: String): Flow<List<Ticket>> {
        return ticketDao.observeRecentTickets(studentId).map { list ->
            list.map { it.toDomain() }
        }
    }

    suspend fun getTicketsForDate(studentId: String, date: String): List<Ticket> {
        return ticketDao.getTicketsForDate(studentId, date).map { it.toDomain() }
    }
}

class TransactionRepository(
    private val api: ApiClient,
    private val transactionDao: TransactionDao
) {
    suspend fun saveTransaction(
        studentId: String,
        timestamp: Long,
        mealType: MealType,
        qrHash: String
    ) {
        val transaction = TransactionEntity(
            id = java.util.UUID.randomUUID().toString(),
            studentId = studentId,
            timestamp = timestamp,
            mealType = mealType.name,
            qrHash = qrHash,
            syncedToServer = false
        )
        transactionDao.insert(transaction)
    }

    suspend fun syncPendingTransactions(): Result<SyncResponse> {
        val pending = transactionDao.getUnsyncedTransactions()
        if (pending.isEmpty()) return Result.success(SyncResponse(0, emptyList()))

        val items = pending.map {
            TransactionSyncItem(
                studentId = it.studentId,
                timestamp = kotlinx.datetime.Instant.fromEpochMilliseconds(it.timestamp).toString(),
                mealType = it.mealType,
                transactionHash = it.qrHash
            )
        }

        return api.syncTransactionsBatch(items).onSuccess {
            transactionDao.markAsSynced(pending.map { it.id })
        }
    }
}

// Mapper extensions
private fun UserEntity.toDomain() = User(
    id = id,
    login = login,
    name = name,
    surname = surname,
    fatherName = fatherName,
    roles = roles.map { Role.valueOf(it) },
    groupId = groupId,
    privateKey = privateKey,
    publicKey = publicKey
)

private fun User.toEntity() = UserEntity(
    id = id,
    login = login,
    name = name,
    surname = surname,
    fatherName = fatherName,
    roles = roles.map { it.name },
    groupId = groupId,
    privateKey = privateKey,
    publicKey = publicKey
)

private fun TicketEntity.toDomain() = Ticket(
    id = id,
    studentId = studentId,
    mealType = MealType.valueOf(mealType),
    date = date,
    isUsed = isUsed
)

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/data/repository/Repositories.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/kotlin/org/pgk/food/data/repository/TokenStorage.kt
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/kotlin/org/pgk/food/data/repository/TokenStorage.kt
# ==============================================================================

package org.pgk.food.data.repository

interface TokenStorage {
    fun saveToken(token: String)
    fun getToken(): String?
    fun clearToken()
    fun getCurrentUserId(): String?
    fun saveUserId(userId: String)
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/kotlin/org/pgk/food/data/repository/TokenStorage.kt --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/compose-multiplatform.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/compose-multiplatform.xml
# ==============================================================================

<vector
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:aapt="http://schemas.android.com/aapt"
    android:width="450dp"
    android:height="450dp"
    android:viewportWidth="64"
    android:viewportHeight="64">
  <path
      android:pathData="M56.25,18V46L32,60 7.75,46V18L32,4Z"
      android:fillColor="#6075f2"/>
  <path
      android:pathData="m41.5,26.5v11L32,43V60L56.25,46V18Z"
      android:fillColor="#6b57ff"/>
  <path
      android:pathData="m32,43 l-9.5,-5.5v-11L7.75,18V46L32,60Z">
    <aapt:attr name="android:fillColor">
      <gradient
          android:centerX="23.131"
          android:centerY="18.441"
          android:gradientRadius="42.132"
          android:type="radial">
        <item android:offset="0" android:color="#FF5383EC"/>
        <item android:offset="0.867" android:color="#FF7F52FF"/>
      </gradient>
    </aapt:attr>
  </path>
  <path
      android:pathData="M22.5,26.5 L32,21 41.5,26.5 56.25,18 32,4 7.75,18Z">
    <aapt:attr name="android:fillColor">
      <gradient
          android:startX="44.172"
          android:startY="4.377"
          android:endX="17.973"
          android:endY="34.035"
          android:type="linear">
        <item android:offset="0" android:color="#FF33C3FF"/>
        <item android:offset="0.878" android:color="#FF5383EC"/>
      </gradient>
    </aapt:attr>
  </path>
  <path
      android:pathData="m32,21 l9.526,5.5v11L32,43 22.474,37.5v-11z"
      android:fillColor="#000000"/>
</vector>

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/compose-multiplatform.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_arrow_left.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_arrow_left.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_arrow_left.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_calendar_edit.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_calendar_edit.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_calendar_edit.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_chart_bar.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_chart_bar.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_chart_bar.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_check_circle.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_check_circle.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_check_circle.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_clock.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_clock.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_clock.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_cloud.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_cloud.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 15a4.5 4.5 0 0 0 4.5 4.5H18a3.75 3.75 0 0 0 1.332-7.257 3 3 0 0 0-3.758-3.848 5.25 5.25 0 0 0-10.233 2.33A4.502 4.502 0 0 0 2.25 15Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_cloud.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_document.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_document.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_document.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_error.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_error.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_error.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_history.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_history.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_history.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_logout.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_logout.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15" />
</svg>

# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_logout.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_profile.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_profile.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_profile.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_qr_code.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_qr_code.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z" />
    <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5h.75v.75h-.75v-.75ZM13.5 19.5h.75v.75h-.75v-.75ZM19.5 13.5h.75v.75h-.75v-.75ZM19.5 19.5h.75v.75h-.75v-.75ZM16.5 16.5h.75v.75h-.75v-.75Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_qr_code.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_settings.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_settings.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z" />
    <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_settings.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_sync.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_sync.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_sync.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_table_cells.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_table_cells.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0 1 12 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m17.25-3.75h-7.5c-.621 0-1.125.504-1.125 1.125m8.625-1.125c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M12 10.875v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125M13.125 12h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125M20.625 12c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5M12 14.625v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 14.625c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m0 1.5v-1.5m0 0c0-.621.504-1.125 1.125-1.125m0 0h7.5" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_table_cells.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_ticket.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_ticket.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_ticket.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_upload.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_upload.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_upload.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_user_add.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_user_add.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_user_add.xml --- 


# ==============================================================================
# Файл: composeApp/src/commonMain/composeResources/drawable/ic_users.xml
# Полный путь (относительно корня сканирования): composeApp/src/commonMain/composeResources/drawable/ic_users.xml
# ==============================================================================

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" />
</svg>


# --- КОНЕЦ ФАЙЛА: composeApp/src/commonMain/composeResources/drawable/ic_users.xml --- 


# ==============================================================================
# Файл: composeApp/src/iosMain/kotlin/org/pgk/food/MainViewController.kt
# Полный путь (относительно корня сканирования): composeApp/src/iosMain/kotlin/org/pgk/food/MainViewController.kt
# ==============================================================================

package org.pgk.food

import androidx.compose.ui.window.ComposeUIViewController

fun MainViewController() = ComposeUIViewController { App() }

# --- КОНЕЦ ФАЙЛА: composeApp/src/iosMain/kotlin/org/pgk/food/MainViewController.kt --- 


# ==============================================================================
# Файл: composeApp/src/iosMain/kotlin/org/pgk/food/Platform.ios.kt
# Полный путь (относительно корня сканирования): composeApp/src/iosMain/kotlin/org/pgk/food/Platform.ios.kt
# ==============================================================================

package org.pgk.food

import platform.UIKit.UIDevice

class IOSPlatform: Platform {
    override val name: String = UIDevice.currentDevice.systemName() + " " + UIDevice.currentDevice.systemVersion
}

actual fun getPlatform(): Platform = IOSPlatform()

# --- КОНЕЦ ФАЙЛА: composeApp/src/iosMain/kotlin/org/pgk/food/Platform.ios.kt --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/AndroidManifest.xml
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/AndroidManifest.xml
# ==============================================================================

<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android">

    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@android:style/Theme.Material.Light.NoActionBar">
        <activity
            android:exported="true"
            android:name=".MainActivity">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest>

# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/AndroidManifest.xml --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/drawable/ic_launcher_background.xml
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/drawable/ic_launcher_background.xml
# ==============================================================================

<?xml version="1.0" encoding="utf-8"?>
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="108"
    android:viewportHeight="108">
    <path
        android:fillColor="#3DDC84"
        android:pathData="M0,0h108v108h-108z" />
    <path
        android:fillColor="#00000000"
        android:pathData="M9,0L9,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,0L19,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M29,0L29,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M39,0L39,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M49,0L49,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M59,0L59,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M69,0L69,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M79,0L79,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M89,0L89,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M99,0L99,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,9L108,9"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,19L108,19"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,29L108,29"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,39L108,39"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,49L108,49"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,59L108,59"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,69L108,69"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,79L108,79"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,89L108,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,99L108,99"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,29L89,29"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,39L89,39"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,49L89,49"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,59L89,59"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,69L89,69"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,79L89,79"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M29,19L29,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M39,19L39,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M49,19L49,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M59,19L59,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M69,19L69,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M79,19L79,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
</vector>

# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/drawable/ic_launcher_background.xml --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/drawable-v24/ic_launcher_foreground.xml
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/drawable-v24/ic_launcher_foreground.xml
# ==============================================================================

<vector xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:aapt="http://schemas.android.com/aapt"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="108"
    android:viewportHeight="108">
    <path android:pathData="M31,63.928c0,0 6.4,-11 12.1,-13.1c7.2,-2.6 26,-1.4 26,-1.4l38.1,38.1L107,108.928l-32,-1L31,63.928z">
        <aapt:attr name="android:fillColor">
            <gradient
                android:endX="85.84757"
                android:endY="92.4963"
                android:startX="42.9492"
                android:startY="49.59793"
                android:type="linear">
                <item
                    android:color="#44000000"
                    android:offset="0.0" />
                <item
                    android:color="#00000000"
                    android:offset="1.0" />
            </gradient>
        </aapt:attr>
    </path>
    <path
        android:fillColor="#FFFFFF"
        android:fillType="nonZero"
        android:pathData="M65.3,45.828l3.8,-6.6c0.2,-0.4 0.1,-0.9 -0.3,-1.1c-0.4,-0.2 -0.9,-0.1 -1.1,0.3l-3.9,6.7c-6.3,-2.8 -13.4,-2.8 -19.7,0l-3.9,-6.7c-0.2,-0.4 -0.7,-0.5 -1.1,-0.3C38.8,38.328 38.7,38.828 38.9,39.228l3.8,6.6C36.2,49.428 31.7,56.028 31,63.928h46C76.3,56.028 71.8,49.428 65.3,45.828zM43.4,57.328c-0.8,0 -1.5,-0.5 -1.8,-1.2c-0.3,-0.7 -0.1,-1.5 0.4,-2.1c0.5,-0.5 1.4,-0.7 2.1,-0.4c0.7,0.3 1.2,1 1.2,1.8C45.3,56.528 44.5,57.328 43.4,57.328L43.4,57.328zM64.6,57.328c-0.8,0 -1.5,-0.5 -1.8,-1.2s-0.1,-1.5 0.4,-2.1c0.5,-0.5 1.4,-0.7 2.1,-0.4c0.7,0.3 1.2,1 1.2,1.8C66.5,56.528 65.6,57.328 64.6,57.328L64.6,57.328z"
        android:strokeWidth="1"
        android:strokeColor="#00000000" />
</vector>

# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/drawable-v24/ic_launcher_foreground.xml --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/mipmap-mdpi/ic_launcher.png
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/mipmap-mdpi/ic_launcher.png
# ==============================================================================

# ОШИБКА: Не удалось прочитать файл 'composeApp/src/androidMain/res/mipmap-mdpi/ic_launcher.png'. Кодировка: utf-8, Ошибка: 'utf-8' codec can't encode character '\udc89' in position 0: surrogates not allowed


# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/mipmap-mdpi/ic_launcher.png --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/mipmap-mdpi/ic_launcher_round.png
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/mipmap-mdpi/ic_launcher_round.png
# ==============================================================================

# ОШИБКА: Не удалось прочитать файл 'composeApp/src/androidMain/res/mipmap-mdpi/ic_launcher_round.png'. Кодировка: utf-8, Ошибка: 'utf-8' codec can't encode character '\udc89' in position 0: surrogates not allowed


# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/mipmap-mdpi/ic_launcher_round.png --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/mipmap-hdpi/ic_launcher.png
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/mipmap-hdpi/ic_launcher.png
# ==============================================================================

# ОШИБКА: Не удалось прочитать файл 'composeApp/src/androidMain/res/mipmap-hdpi/ic_launcher.png'. Кодировка: utf-8, Ошибка: 'utf-8' codec can't encode character '\udc89' in position 0: surrogates not allowed


# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/mipmap-hdpi/ic_launcher.png --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/mipmap-hdpi/ic_launcher_round.png
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/mipmap-hdpi/ic_launcher_round.png
# ==============================================================================

# ОШИБКА: Не удалось прочитать файл 'composeApp/src/androidMain/res/mipmap-hdpi/ic_launcher_round.png'. Кодировка: utf-8, Ошибка: 'utf-8' codec can't encode character '\udc89' in position 0: surrogates not allowed


# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/mipmap-hdpi/ic_launcher_round.png --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/mipmap-xhdpi/ic_launcher.png
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/mipmap-xhdpi/ic_launcher.png
# ==============================================================================

# ОШИБКА: Не удалось прочитать файл 'composeApp/src/androidMain/res/mipmap-xhdpi/ic_launcher.png'. Кодировка: utf-8, Ошибка: 'utf-8' codec can't encode character '\udc89' in position 0: surrogates not allowed


# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/mipmap-xhdpi/ic_launcher.png --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/mipmap-xhdpi/ic_launcher_round.png
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/mipmap-xhdpi/ic_launcher_round.png
# ==============================================================================

# ОШИБКА: Не удалось прочитать файл 'composeApp/src/androidMain/res/mipmap-xhdpi/ic_launcher_round.png'. Кодировка: utf-8, Ошибка: 'utf-8' codec can't encode character '\udc89' in position 0: surrogates not allowed


# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/mipmap-xhdpi/ic_launcher_round.png --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/mipmap-xxxhdpi/ic_launcher.png
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/mipmap-xxxhdpi/ic_launcher.png
# ==============================================================================

# ОШИБКА: Не удалось прочитать файл 'composeApp/src/androidMain/res/mipmap-xxxhdpi/ic_launcher.png'. Кодировка: utf-8, Ошибка: 'utf-8' codec can't encode character '\udc89' in position 0: surrogates not allowed


# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/mipmap-xxxhdpi/ic_launcher.png --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/mipmap-xxxhdpi/ic_launcher_round.png
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/mipmap-xxxhdpi/ic_launcher_round.png
# ==============================================================================

# ОШИБКА: Не удалось прочитать файл 'composeApp/src/androidMain/res/mipmap-xxxhdpi/ic_launcher_round.png'. Кодировка: utf-8, Ошибка: 'utf-8' codec can't encode character '\udc89' in position 0: surrogates not allowed


# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/mipmap-xxxhdpi/ic_launcher_round.png --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/mipmap-anydpi-v26/ic_launcher.xml
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/mipmap-anydpi-v26/ic_launcher.xml
# ==============================================================================

<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@drawable/ic_launcher_background" />
    <foreground android:drawable="@drawable/ic_launcher_foreground" />
</adaptive-icon>

# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/mipmap-anydpi-v26/ic_launcher.xml --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/mipmap-anydpi-v26/ic_launcher_round.xml
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/mipmap-anydpi-v26/ic_launcher_round.xml
# ==============================================================================

<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@drawable/ic_launcher_background" />
    <foreground android:drawable="@drawable/ic_launcher_foreground" />
</adaptive-icon>

# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/mipmap-anydpi-v26/ic_launcher_round.xml --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/values/strings.xml
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/values/strings.xml
# ==============================================================================

<resources>
    <string name="app_name">PgkFood</string>
</resources>

# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/values/strings.xml --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/mipmap-xxhdpi/ic_launcher.png
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/mipmap-xxhdpi/ic_launcher.png
# ==============================================================================

# ОШИБКА: Не удалось прочитать файл 'composeApp/src/androidMain/res/mipmap-xxhdpi/ic_launcher.png'. Кодировка: utf-8, Ошибка: 'utf-8' codec can't encode character '\udc89' in position 0: surrogates not allowed


# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/mipmap-xxhdpi/ic_launcher.png --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/res/mipmap-xxhdpi/ic_launcher_round.png
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/res/mipmap-xxhdpi/ic_launcher_round.png
# ==============================================================================

# ОШИБКА: Не удалось прочитать файл 'composeApp/src/androidMain/res/mipmap-xxhdpi/ic_launcher_round.png'. Кодировка: utf-8, Ошибка: 'utf-8' codec can't encode character '\udc89' in position 0: surrogates not allowed


# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/res/mipmap-xxhdpi/ic_launcher_round.png --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/kotlin/org/pgk/food/MainActivity.kt
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/kotlin/org/pgk/food/MainActivity.kt
# ==============================================================================

package org.pgk.food

import android.os.Bundle
import androidx.activity.ComponentActivity
import androidx.activity.compose.setContent
import androidx.activity.enableEdgeToEdge
import androidx.compose.runtime.Composable
import androidx.compose.ui.tooling.preview.Preview

class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        enableEdgeToEdge()
        super.onCreate(savedInstanceState)

        setContent {
            App()
        }
    }
}

@Preview
@Composable
fun AppAndroidPreview() {
    App()
}

# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/kotlin/org/pgk/food/MainActivity.kt --- 


# ==============================================================================
# Файл: composeApp/src/androidMain/kotlin/org/pgk/food/Platform.android.kt
# Полный путь (относительно корня сканирования): composeApp/src/androidMain/kotlin/org/pgk/food/Platform.android.kt
# ==============================================================================

package org.pgk.food

import android.os.Build

class AndroidPlatform : Platform {
    override val name: String = "Android ${Build.VERSION.SDK_INT}"
}

actual fun getPlatform(): Platform = AndroidPlatform()

# --- КОНЕЦ ФАЙЛА: composeApp/src/androidMain/kotlin/org/pgk/food/Platform.android.kt --- 



# ==============================================================================
# СТРУКТУРА ПРОЕКТА: kmp-presentation
# ==============================================================================

kmp-presentation/
├── composeApp
│   ├── src
│   │   ├── androidMain
│   │   │   ├── kotlin
│   │   │   │   └── org
│   │   │   │       └── pgk
│   │   │   │           └── food
│   │   │   │               ├── MainActivity.kt
│   │   │   │               └── Platform.android.kt
│   │   │   ├── res
│   │   │   │   ├── drawable
│   │   │   │   │   └── ic_launcher_background.xml
│   │   │   │   ├── drawable-v24
│   │   │   │   │   └── ic_launcher_foreground.xml
│   │   │   │   ├── mipmap-anydpi-v26
│   │   │   │   │   ├── ic_launcher.xml
│   │   │   │   │   └── ic_launcher_round.xml
│   │   │   │   ├── mipmap-hdpi
│   │   │   │   │   ├── ic_launcher.png
│   │   │   │   │   └── ic_launcher_round.png
│   │   │   │   ├── mipmap-mdpi
│   │   │   │   │   ├── ic_launcher.png
│   │   │   │   │   └── ic_launcher_round.png
│   │   │   │   ├── mipmap-xhdpi
│   │   │   │   │   ├── ic_launcher.png
│   │   │   │   │   └── ic_launcher_round.png
│   │   │   │   ├── mipmap-xxhdpi
│   │   │   │   │   ├── ic_launcher.png
│   │   │   │   │   └── ic_launcher_round.png
│   │   │   │   ├── mipmap-xxxhdpi
│   │   │   │   │   ├── ic_launcher.png
│   │   │   │   │   └── ic_launcher_round.png
│   │   │   │   └── values
│   │   │   │       └── strings.xml
│   │   │   └── AndroidManifest.xml
│   │   ├── commonMain
│   │   │   ├── composeResources
│   │   │   │   └── drawable
│   │   │   │       ├── compose-multiplatform.xml
│   │   │   │       ├── ic_arrow_left.xml
│   │   │   │       ├── ic_calendar_edit.xml
│   │   │   │       ├── ic_chart_bar.xml
│   │   │   │       ├── ic_check_circle.xml
│   │   │   │       ├── ic_clock.xml
│   │   │   │       ├── ic_cloud.xml
│   │   │   │       ├── ic_document.xml
│   │   │   │       ├── ic_error.xml
│   │   │   │       ├── ic_history.xml
│   │   │   │       ├── ic_logout.xml
│   │   │   │       ├── ic_profile.xml
│   │   │   │       ├── ic_qr_code.xml
│   │   │   │       ├── ic_settings.xml
│   │   │   │       ├── ic_sync.xml
│   │   │   │       ├── ic_table_cells.xml
│   │   │   │       ├── ic_ticket.xml
│   │   │   │       ├── ic_upload.xml
│   │   │   │       ├── ic_user_add.xml
│   │   │   │       └── ic_users.xml
│   │   │   └── kotlin
│   │   │       └── org
│   │   │           └── pgk
│   │   │               └── food
│   │   │                   ├── data
│   │   │                   │   ├── local
│   │   │                   │   │   ├── dao
│   │   │                   │   │   │   └── Daos.kt
│   │   │                   │   │   ├── database
│   │   │                   │   │   │   └── AppDatabase.kt
│   │   │                   │   │   └── entities
│   │   │                   │   │       └── Entities.kt
│   │   │                   │   ├── remote
│   │   │                   │   │   ├── api
│   │   │                   │   │   │   └── ApiClient.kt
│   │   │                   │   │   └── dto
│   │   │                   │   │       └── RemoteDto.kt
│   │   │                   │   └── repository
│   │   │                   │       ├── Repositories.kt
│   │   │                   │       └── TokenStorage.kt
│   │   │                   ├── di
│   │   │                   │   ├── AppModule.kt
│   │   │                   │   ├── CommonDi.kt
│   │   │                   │   ├── TokenStorage.android.kt
│   │   │                   │   └── TokenStorage.ios.kt
│   │   │                   ├── domain
│   │   │                   │   ├── model
│   │   │                   │   │   └── Models.kt
│   │   │                   │   └── usecase
│   │   │                   │       └── UseCases.kt
│   │   │                   ├── presentation
│   │   │                   │   ├── components
│   │   │                   │   │   ├── CommonComponents.kt
│   │   │                   │   │   ├── QRCodeView.kt
│   │   │                   │   │   ├── QuickActionCard.kt
│   │   │                   │   │   └── TicketCard.kt
│   │   │                   │   ├── navigation
│   │   │                   │   │   └── AppNavigation.kt
│   │   │                   │   └── screens
│   │   │                   │       ├── admin
│   │   │                   │       │   ├── AdminDashboard.kt
│   │   │                   │       │   ├── AdminDashboardScreen.kt
│   │   │                   │       │   ├── AdminViewModel.kt
│   │   │                   │       │   ├── RegisterScreen.kt
│   │   │                   │       │   ├── ReportsScreen.kt
│   │   │                   │       │   └── SettingsScreen.kt
│   │   │                   │       ├── auth
│   │   │                   │       │   ├── LoginScreen.kt
│   │   │                   │       │   └── LoginViewModel.kt
│   │   │                   │       ├── common
│   │   │                   │       │   └── Stubs.kt
│   │   │                   │       ├── cook
│   │   │                   │       │   ├── CookHomeScreen.kt
│   │   │                   │       │   ├── HistoryScreen.kt
│   │   │                   │       │   └── QRScannerScreen.kt
│   │   │                   │       ├── curator
│   │   │                   │       │   └── CuratorHomeScreen.kt
│   │   │                   │       ├── registrar
│   │   │                   │       │   ├── CreateUserScreen.kt
│   │   │                   │       │   ├── RegistrarHomeScreen.kt
│   │   │                   │       │   └── RegistrarViewModel.kt
│   │   │                   │       └── student
│   │   │                   │           ├── ProfileScreen.kt
│   │   │                   │           ├── QRCodeScreen.kt
│   │   │                   │           ├── StudentHomeScreen.kt
│   │   │                   │           └── StudentHomeViewModel.kt
│   │   │                   ├── ui
│   │   │                   │   └── theme
│   │   │                   │       ├── Color.kt
│   │   │                   │       └── Theme.kt
│   │   │                   ├── utils
│   │   │                   │   ├── QRGenerator.kt
│   │   │                   │   ├── TokenValidator.kt
│   │   │                   │   └── TOTPValidator.kt
│   │   │                   ├── App.kt
│   │   │                   ├── Greeting.kt
│   │   │                   └── Platform.kt
│   │   ├── commonTest
│   │   │   └── kotlin
│   │   │       └── org
│   │   │           └── pgk
│   │   │               └── food
│   │   │                   └── ComposeAppCommonTest.kt
│   │   └── iosMain
│   │       └── kotlin
│   │           └── org
│   │               └── pgk
│   │                   └── food
│   │                       ├── MainViewController.kt
│   │                       └── Platform.ios.kt
│   └── build.gradle.kts
├── gradle
│   ├── wrapper
│   │   ├── gradle-wrapper.jar
│   │   └── gradle-wrapper.properties
│   └── libs.versions.toml
├── iosApp
│   ├── Configuration
│   │   └── Config.xcconfig
│   ├── iosApp
│   │   ├── Assets.xcassets
│   │   │   ├── AccentColor.colorset
│   │   │   │   └── Contents.json
│   │   │   ├── AppIcon.appiconset
│   │   │   │   ├── app-icon-1024.png
│   │   │   │   └── Contents.json
│   │   │   └── Contents.json
│   │   ├── Preview Content
│   │   │   └── Preview Assets.xcassets
│   │   │       └── Contents.json
│   │   ├── ContentView.swift
│   │   ├── Info.plist
│   │   └── iOSApp.swift
│   └── iosApp.xcodeproj
│       ├── project.xcworkspace
│       │   └── contents.xcworkspacedata
│       └── project.pbxproj
├── build.gradle.kts
├── gradle.properties
├── gradlew
├── gradlew.bat
├── project_dumper.py
├── README.md
├── RESULT.txt
└── settings.gradle.kts
